import{r as c}from"./elliptic-DJKB8ZKo.js";import{r as h}from"./bn.js-Dqs6ZoTB.js";var p,y;function m(){if(y)return p;y=1;var a=c(),o=h();p=function(r){return new s(r)};var i={secp256k1:{name:"secp256k1",byteLength:32},secp224r1:{name:"p224",byteLength:28},prime256v1:{name:"p256",byteLength:32},prime192v1:{name:"p192",byteLength:24},ed25519:{name:"ed25519",byteLength:32},secp384r1:{name:"p384",byteLength:48},secp521r1:{name:"p521",byteLength:66}};i.p224=i.secp224r1,i.p256=i.secp256r1=i.prime256v1,i.p192=i.secp192r1=i.prime192v1,i.p384=i.secp384r1,i.p521=i.secp521r1;function s(e){this.curveType=i[e],this.curveType||(this.curveType={name:e}),this.curve=new a.ec(this.curveType.name),this.keys=void 0}s.prototype.generateKeys=function(e,r){return this.keys=this.curve.genKeyPair(),this.getPublicKey(e,r)},s.prototype.computeSecret=function(e,r,t){r=r||"utf8",Buffer.isBuffer(e)||(e=new Buffer(e,r));var u=this.curve.keyFromPublic(e).getPublic(),n=u.mul(this.keys.getPrivate()).getX();return f(n,t,this.curveType.byteLength)},s.prototype.getPublicKey=function(e,r){var t=this.keys.getPublic(r==="compressed",!0);return r==="hybrid"&&(t[t.length-1]%2?t[0]=7:t[0]=6),f(t,e)},s.prototype.getPrivateKey=function(e){return f(this.keys.getPrivate(),e)},s.prototype.setPublicKey=function(e,r){return r=r||"utf8",Buffer.isBuffer(e)||(e=new Buffer(e,r)),this.keys._importPublic(e),this},s.prototype.setPrivateKey=function(e,r){r=r||"utf8",Buffer.isBuffer(e)||(e=new Buffer(e,r));var t=new o(e);return t=t.toString(16),this.keys=this.curve.genKeyPair(),this.keys._importPrivate(t),this};function f(e,r,t){Array.isArray(e)||(e=e.toArray());var u=new Buffer(e);if(t&&u.length<t){var n=new Buffer(t-u.length);n.fill(0),u=Buffer.concat([n,u])}return r?u.toString(r):u}return p}export{m as r};
