import{r as _e}from"./safe-buffer-BaiuebXe.js";import{r as lr}from"./create-hash-BLm9U7cx.js";import{r as Tt,c as Zt}from"./asn1.js-CNcqmYN1.js";import{r as Ft}from"./process-nextick-args-hr2U_nH5.js";import{r as ur}from"./isarray-aIBLcMhd.js";import{r as Ot}from"./core-util-is-D3ZpDi90.js";import{r as Lt}from"./inherits-BICa84dG.js";import{r as dr}from"./util-deprecate-Do5wlsJu.js";import{r as cr}from"./create-hmac-E3TCb32w.js";import{r as pr}from"./browserify-rsa-jChIhXo8.js";import{r as tr}from"./elliptic-DJKB8ZKo.js";import{r as er}from"./parse-asn1-Bz7HmeTk.js";const vr={sign:"rsa",hash:"sha224",id:"302d300d06096086480165030402040500041c"},gr={sign:"rsa",hash:"sha256",id:"3031300d060960864801650304020105000420"},mr={sign:"rsa",hash:"sha384",id:"3041300d060960864801650304020205000430"},wr={sign:"rsa",hash:"sha512",id:"3051300d060960864801650304020305000440"},yr={sign:"ecdsa",hash:"sha256",id:""},Mr={sign:"ecdsa",hash:"sha224",id:""},br={sign:"ecdsa",hash:"sha384",id:""},_r={sign:"ecdsa",hash:"sha512",id:""},xr={sign:"dsa",hash:"sha1",id:""},Sr={sign:"rsa",hash:"rmd160",id:"3021300906052b2403020105000414"},Rr={sign:"rsa",hash:"md5",id:"3020300c06082a864886f70d020505000410"},rr={sha224WithRSAEncryption:vr,"RSA-SHA224":{sign:"ecdsa/rsa",hash:"sha224",id:"302d300d06096086480165030402040500041c"},sha256WithRSAEncryption:gr,"RSA-SHA256":{sign:"ecdsa/rsa",hash:"sha256",id:"3031300d060960864801650304020105000420"},sha384WithRSAEncryption:mr,"RSA-SHA384":{sign:"ecdsa/rsa",hash:"sha384",id:"3041300d060960864801650304020205000430"},sha512WithRSAEncryption:wr,"RSA-SHA512":{sign:"ecdsa/rsa",hash:"sha512",id:"3051300d060960864801650304020305000440"},"RSA-SHA1":{sign:"rsa",hash:"sha1",id:"3021300906052b0e03021a05000414"},"ecdsa-with-SHA1":{sign:"ecdsa",hash:"sha1",id:""},sha256:yr,sha224:Mr,sha384:br,sha512:_r,"DSA-SHA":{sign:"dsa",hash:"sha1",id:""},"DSA-SHA1":{sign:"dsa",hash:"sha1",id:""},DSA:xr,"DSA-WITH-SHA224":{sign:"dsa",hash:"sha224",id:""},"DSA-SHA224":{sign:"dsa",hash:"sha224",id:""},"DSA-WITH-SHA256":{sign:"dsa",hash:"sha256",id:""},"DSA-SHA256":{sign:"dsa",hash:"sha256",id:""},"DSA-WITH-SHA384":{sign:"dsa",hash:"sha384",id:""},"DSA-SHA384":{sign:"dsa",hash:"sha384",id:""},"DSA-WITH-SHA512":{sign:"dsa",hash:"sha512",id:""},"DSA-SHA512":{sign:"dsa",hash:"sha512",id:""},"DSA-RIPEMD160":{sign:"dsa",hash:"rmd160",id:""},ripemd160WithRSA:Sr,"RSA-RIPEMD160":{sign:"rsa",hash:"rmd160",id:"3021300906052b2403020105000414"},md5WithRSAEncryption:Rr,"RSA-MD5":{sign:"rsa",hash:"md5",id:"3020300c06082a864886f70d020505000410"}};var le,We;function Kr(){return We||(We=1,le=rr),le}var It={exports:{}},ue,He;function ir(){return He||(He=1,ue=Tt.EventEmitter),ue}var Pt={exports:{}},Oe;function xe(){return Oe||(Oe=1,function(x,k){var D=Tt,g=D.Buffer;function L(w,M){for(var b in w)M[b]=w[b]}g.from&&g.alloc&&g.allocUnsafe&&g.allocUnsafeSlow?x.exports=D:(L(D,k),k.Buffer=u);function u(w,M,b){return g(w,M,b)}L(g,u),u.from=function(w,M,b){if(typeof w=="number")throw new TypeError("Argument must not be a number");return g(w,M,b)},u.alloc=function(w,M,b){if(typeof w!="number")throw new TypeError("Argument must be a number");var S=g(w);return M!==void 0?typeof b=="string"?S.fill(M,b):S.fill(M):S.fill(0),S},u.allocUnsafe=function(w){if(typeof w!="number")throw new TypeError("Argument must be a number");return g(w)},u.allocUnsafeSlow=function(w){if(typeof w!="number")throw new TypeError("Argument must be a number");return D.SlowBuffer(w)}}(Pt,Pt.exports)),Pt.exports}var de={exports:{}},Ie;function Er(){return Ie||(Ie=1,function(x){function k(u,w){if(!(u instanceof w))throw new TypeError("Cannot call a class as a function")}var D=xe().Buffer,g=Tt;function L(u,w,M){u.copy(w,M)}x.exports=function(){function u(){k(this,u),this.head=null,this.tail=null,this.length=0}return u.prototype.push=function(M){var b={data:M,next:null};this.length>0?this.tail.next=b:this.head=b,this.tail=b,++this.length},u.prototype.unshift=function(M){var b={data:M,next:this.head};this.length===0&&(this.tail=b),this.head=b,++this.length},u.prototype.shift=function(){if(this.length!==0){var M=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,M}},u.prototype.clear=function(){this.head=this.tail=null,this.length=0},u.prototype.join=function(M){if(this.length===0)return"";for(var b=this.head,S=""+b.data;b=b.next;)S+=M+b.data;return S},u.prototype.concat=function(M){if(this.length===0)return D.alloc(0);for(var b=D.allocUnsafe(M>>>0),S=this.head,W=0;S;)L(S.data,b,W),W+=S.data.length,S=S.next;return b},u}(),g&&g.inspect&&g.inspect.custom&&(x.exports.prototype[g.inspect.custom]=function(){var u=g.inspect({length:this.length});return this.constructor.name+" "+u})}(de)),de.exports}var ce,Pe;function nr(){if(Pe)return ce;Pe=1;var x=Ft();function k(L,u){var w=this,M=this._readableState&&this._readableState.destroyed,b=this._writableState&&this._writableState.destroyed;return M||b?(u?u(L):L&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,x.nextTick(g,this,L)):x.nextTick(g,this,L)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(L||null,function(S){!u&&S?w._writableState?w._writableState.errorEmitted||(w._writableState.errorEmitted=!0,x.nextTick(g,w,S)):x.nextTick(g,w,S):u&&u(S)}),this)}function D(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function g(L,u){L.emit("error",u)}return ce={destroy:k,undestroy:D},ce}var pe,Ue;function ar(){if(Ue)return pe;Ue=1;var x=Ft();pe=O;function k(i){var n=this;this.next=null,this.entry=null,this.finish=function(){a(n,i)}}var D=!process.browser&&["v0.10","v0.9."].indexOf(process.version.slice(0,5))>-1?setImmediate:x.nextTick,g;O.WritableState=H;var L=Object.create(Ot());L.inherits=Lt();var u={deprecate:dr()},w=ir(),M=xe().Buffer,b=(typeof Zt<"u"?Zt:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function S(i){return M.from(i)}function W(i){return M.isBuffer(i)||i instanceof b}var y=nr();L.inherits(O,w);function q(){}function H(i,n){g=g||Ct(),i=i||{};var s=n instanceof g;this.objectMode=!!i.objectMode,s&&(this.objectMode=this.objectMode||!!i.writableObjectMode);var c=i.highWaterMark,f=i.writableHighWaterMark,e=this.objectMode?16:16*1024;c||c===0?this.highWaterMark=c:s&&(f||f===0)?this.highWaterMark=f:this.highWaterMark=e,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var o=i.decodeStrings===!1;this.decodeStrings=!o,this.defaultEncoding=i.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(B){At(n,B)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new k(this)}H.prototype.getBuffer=function(){for(var n=this.bufferedRequest,s=[];n;)s.push(n),n=n.next;return s},function(){try{Object.defineProperty(H.prototype,"buffer",{get:u.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}();var U;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(U=Function.prototype[Symbol.hasInstance],Object.defineProperty(O,Symbol.hasInstance,{value:function(i){return U.call(this,i)?!0:this!==O?!1:i&&i._writableState instanceof H}})):U=function(i){return i instanceof this};function O(i){if(g=g||Ct(),!U.call(O,this)&&!(this instanceof g))return new O(i);this._writableState=new H(i,this),this.writable=!0,i&&(typeof i.write=="function"&&(this._write=i.write),typeof i.writev=="function"&&(this._writev=i.writev),typeof i.destroy=="function"&&(this._destroy=i.destroy),typeof i.final=="function"&&(this._final=i.final)),w.call(this)}O.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))};function V(i,n){var s=new Error("write after end");i.emit("error",s),x.nextTick(n,s)}function p(i,n,s,c){var f=!0,e=!1;return s===null?e=new TypeError("May not write null values to stream"):typeof s!="string"&&s!==void 0&&!n.objectMode&&(e=new TypeError("Invalid non-string/buffer chunk")),e&&(i.emit("error",e),x.nextTick(c,e),f=!1),f}O.prototype.write=function(i,n,s){var c=this._writableState,f=!1,e=!c.objectMode&&W(i);return e&&!M.isBuffer(i)&&(i=S(i)),typeof n=="function"&&(s=n,n=null),e?n="buffer":n||(n=c.defaultEncoding),typeof s!="function"&&(s=q),c.ended?V(this,s):(e||p(this,c,i,s))&&(c.pendingcb++,f=R(this,c,e,i,n,s)),f},O.prototype.cork=function(){var i=this._writableState;i.corked++},O.prototype.uncork=function(){var i=this._writableState;i.corked&&(i.corked--,!i.writing&&!i.corked&&!i.bufferProcessing&&i.bufferedRequest&&kt(this,i))},O.prototype.setDefaultEncoding=function(n){if(typeof n=="string"&&(n=n.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((n+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+n);return this._writableState.defaultEncoding=n,this};function v(i,n,s){return!i.objectMode&&i.decodeStrings!==!1&&typeof n=="string"&&(n=M.from(n,s)),n}Object.defineProperty(O.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function R(i,n,s,c,f,e){if(!s){var o=v(n,c,f);c!==o&&(s=!0,f="buffer",c=o)}var B=n.objectMode?1:c.length;n.length+=B;var T=n.length<n.highWaterMark;if(T||(n.needDrain=!0),n.writing||n.corked){var N=n.lastBufferedRequest;n.lastBufferedRequest={chunk:c,encoding:f,isBuf:s,callback:e,next:null},N?N.next=n.lastBufferedRequest:n.bufferedRequest=n.lastBufferedRequest,n.bufferedRequestCount+=1}else A(i,n,!1,B,c,f,e);return T}function A(i,n,s,c,f,e,o){n.writelen=c,n.writecb=o,n.writing=!0,n.sync=!0,s?i._writev(f,n.onwrite):i._write(f,e,n.onwrite),n.sync=!1}function I(i,n,s,c,f){--n.pendingcb,s?(x.nextTick(f,c),x.nextTick(t,i,n),i._writableState.errorEmitted=!0,i.emit("error",c)):(f(c),i._writableState.errorEmitted=!0,i.emit("error",c),t(i,n))}function j(i){i.writing=!1,i.writecb=null,i.length-=i.writelen,i.writelen=0}function At(i,n){var s=i._writableState,c=s.sync,f=s.writecb;if(j(s),n)I(i,s,c,n,f);else{var e=Z(s);!e&&!s.corked&&!s.bufferProcessing&&s.bufferedRequest&&kt(i,s),c?D(F,i,s,e,f):F(i,s,e,f)}}function F(i,n,s,c){s||Y(i,n),n.pendingcb--,c(),t(i,n)}function Y(i,n){n.length===0&&n.needDrain&&(n.needDrain=!1,i.emit("drain"))}function kt(i,n){n.bufferProcessing=!0;var s=n.bufferedRequest;if(i._writev&&s&&s.next){var c=n.bufferedRequestCount,f=new Array(c),e=n.corkedRequestsFree;e.entry=s;for(var o=0,B=!0;s;)f[o]=s,s.isBuf||(B=!1),s=s.next,o+=1;f.allBuffers=B,A(i,n,!0,n.length,f,"",e.finish),n.pendingcb++,n.lastBufferedRequest=null,e.next?(n.corkedRequestsFree=e.next,e.next=null):n.corkedRequestsFree=new k(n),n.bufferedRequestCount=0}else{for(;s;){var T=s.chunk,N=s.encoding,h=s.callback,l=n.objectMode?1:T.length;if(A(i,n,!1,l,T,N,h),s=s.next,n.bufferedRequestCount--,n.writing)break}s===null&&(n.lastBufferedRequest=null)}n.bufferedRequest=s,n.bufferProcessing=!1}O.prototype._write=function(i,n,s){s(new Error("_write() is not implemented"))},O.prototype._writev=null,O.prototype.end=function(i,n,s){var c=this._writableState;typeof i=="function"?(s=i,i=null,n=null):typeof n=="function"&&(s=n,n=null),i!=null&&this.write(i,n),c.corked&&(c.corked=1,this.uncork()),c.ending||r(this,c,s)};function Z(i){return i.ending&&i.length===0&&i.bufferedRequest===null&&!i.finished&&!i.writing}function Bt(i,n){i._final(function(s){n.pendingcb--,s&&i.emit("error",s),n.prefinished=!0,i.emit("prefinish"),t(i,n)})}function d(i,n){!n.prefinished&&!n.finalCalled&&(typeof i._final=="function"?(n.pendingcb++,n.finalCalled=!0,x.nextTick(Bt,i,n)):(n.prefinished=!0,i.emit("prefinish")))}function t(i,n){var s=Z(n);return s&&(d(i,n),n.pendingcb===0&&(n.finished=!0,i.emit("finish"))),s}function r(i,n,s){n.ending=!0,t(i,n),s&&(n.finished?x.nextTick(s):i.once("finish",s)),n.ended=!0,i.writable=!1}function a(i,n,s){var c=i.entry;for(i.entry=null;c;){var f=c.callback;n.pendingcb--,f(s),c=c.next}n.corkedRequestsFree.next=i}return Object.defineProperty(O.prototype,"destroyed",{get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(i){this._writableState&&(this._writableState.destroyed=i)}}),O.prototype.destroy=y.destroy,O.prototype._undestroy=y.undestroy,O.prototype._destroy=function(i,n){this.end(),n(i)},pe}var ve,je;function Ct(){if(je)return ve;je=1;var x=Ft(),k=Object.keys||function(y){var q=[];for(var H in y)q.push(H);return q};ve=b;var D=Object.create(Ot());D.inherits=Lt();var g=fr(),L=ar();D.inherits(b,g);for(var u=k(L.prototype),w=0;w<u.length;w++){var M=u[w];b.prototype[M]||(b.prototype[M]=L.prototype[M])}function b(y){if(!(this instanceof b))return new b(y);g.call(this,y),L.call(this,y),y&&y.readable===!1&&(this.readable=!1),y&&y.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,y&&y.allowHalfOpen===!1&&(this.allowHalfOpen=!1),this.once("end",S)}Object.defineProperty(b.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function S(){this.allowHalfOpen||this._writableState.ended||x.nextTick(W,this)}function W(y){y.end()}return Object.defineProperty(b.prototype,"destroyed",{get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(y){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=y,this._writableState.destroyed=y)}}),b.prototype._destroy=function(y,q){this.push(null),this.end(),x.nextTick(q,y)},ve}var ge={},Ut={exports:{}},Ze;function Ar(){return Ze||(Ze=1,function(x,k){var D=Tt,g=D.Buffer;function L(w,M){for(var b in w)M[b]=w[b]}g.from&&g.alloc&&g.allocUnsafe&&g.allocUnsafeSlow?x.exports=D:(L(D,k),k.Buffer=u);function u(w,M,b){return g(w,M,b)}L(g,u),u.from=function(w,M,b){if(typeof w=="number")throw new TypeError("Argument must not be a number");return g(w,M,b)},u.alloc=function(w,M,b){if(typeof w!="number")throw new TypeError("Argument must be a number");var S=g(w);return M!==void 0?typeof b=="string"?S.fill(M,b):S.fill(M):S.fill(0),S},u.allocUnsafe=function(w){if(typeof w!="number")throw new TypeError("Argument must be a number");return g(w)},u.allocUnsafeSlow=function(w){if(typeof w!="number")throw new TypeError("Argument must be a number");return D.SlowBuffer(w)}}(Ut,Ut.exports)),Ut.exports}var Fe;function Ke(){if(Fe)return ge;Fe=1;var x=Ar().Buffer,k=x.isEncoding||function(p){switch(p=""+p,p&&p.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function D(p){if(!p)return"utf8";for(var v;;)switch(p){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return p;default:if(v)return;p=(""+p).toLowerCase(),v=!0}}function g(p){var v=D(p);if(typeof v!="string"&&(x.isEncoding===k||!k(p)))throw new Error("Unknown encoding: "+p);return v||p}ge.StringDecoder=L;function L(p){this.encoding=g(p);var v;switch(this.encoding){case"utf16le":this.text=y,this.end=q,v=4;break;case"utf8":this.fillLast=b,v=4;break;case"base64":this.text=H,this.end=U,v=3;break;default:this.write=O,this.end=V;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=x.allocUnsafe(v)}L.prototype.write=function(p){if(p.length===0)return"";var v,R;if(this.lastNeed){if(v=this.fillLast(p),v===void 0)return"";R=this.lastNeed,this.lastNeed=0}else R=0;return R<p.length?v?v+this.text(p,R):this.text(p,R):v||""},L.prototype.end=W,L.prototype.text=S,L.prototype.fillLast=function(p){if(this.lastNeed<=p.length)return p.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);p.copy(this.lastChar,this.lastTotal-this.lastNeed,0,p.length),this.lastNeed-=p.length};function u(p){return p<=127?0:p>>5===6?2:p>>4===14?3:p>>3===30?4:p>>6===2?-1:-2}function w(p,v,R){var A=v.length-1;if(A<R)return 0;var I=u(v[A]);return I>=0?(I>0&&(p.lastNeed=I-1),I):--A<R||I===-2?0:(I=u(v[A]),I>=0?(I>0&&(p.lastNeed=I-2),I):--A<R||I===-2?0:(I=u(v[A]),I>=0?(I>0&&(I===2?I=0:p.lastNeed=I-3),I):0))}function M(p,v,R){if((v[0]&192)!==128)return p.lastNeed=0,"�";if(p.lastNeed>1&&v.length>1){if((v[1]&192)!==128)return p.lastNeed=1,"�";if(p.lastNeed>2&&v.length>2&&(v[2]&192)!==128)return p.lastNeed=2,"�"}}function b(p){var v=this.lastTotal-this.lastNeed,R=M(this,p);if(R!==void 0)return R;if(this.lastNeed<=p.length)return p.copy(this.lastChar,v,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);p.copy(this.lastChar,v,0,p.length),this.lastNeed-=p.length}function S(p,v){var R=w(this,p,v);if(!this.lastNeed)return p.toString("utf8",v);this.lastTotal=R;var A=p.length-(R-this.lastNeed);return p.copy(this.lastChar,0,A),p.toString("utf8",v,A)}function W(p){var v=p&&p.length?this.write(p):"";return this.lastNeed?v+"�":v}function y(p,v){if((p.length-v)%2===0){var R=p.toString("utf16le",v);if(R){var A=R.charCodeAt(R.length-1);if(A>=55296&&A<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=p[p.length-2],this.lastChar[1]=p[p.length-1],R.slice(0,-1)}return R}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=p[p.length-1],p.toString("utf16le",v,p.length-1)}function q(p){var v=p&&p.length?this.write(p):"";if(this.lastNeed){var R=this.lastTotal-this.lastNeed;return v+this.lastChar.toString("utf16le",0,R)}return v}function H(p,v){var R=(p.length-v)%3;return R===0?p.toString("base64",v):(this.lastNeed=3-R,this.lastTotal=3,R===1?this.lastChar[0]=p[p.length-1]:(this.lastChar[0]=p[p.length-2],this.lastChar[1]=p[p.length-1]),p.toString("base64",v,p.length-R))}function U(p){var v=p&&p.length?this.write(p):"";return this.lastNeed?v+this.lastChar.toString("base64",0,3-this.lastNeed):v}function O(p){return p.toString(this.encoding)}function V(p){return p&&p.length?this.write(p):""}return ge}var me,$e;function fr(){if($e)return me;$e=1;var x=Ft();me=v;var k=ur(),D;v.ReadableState=p,Tt.EventEmitter;var g=function(h,l){return h.listeners(l).length},L=ir(),u=xe().Buffer,w=(typeof Zt<"u"?Zt:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function M(h){return u.from(h)}function b(h){return u.isBuffer(h)||h instanceof w}var S=Object.create(Ot());S.inherits=Lt();var W=Tt,y=void 0;W&&W.debuglog?y=W.debuglog("stream"):y=function(){};var q=Er(),H=nr(),U;S.inherits(v,L);var O=["error","close","destroy","pause","resume"];function V(h,l,m){if(typeof h.prependListener=="function")return h.prependListener(l,m);!h._events||!h._events[l]?h.on(l,m):k(h._events[l])?h._events[l].unshift(m):h._events[l]=[m,h._events[l]]}function p(h,l){D=D||Ct(),h=h||{};var m=l instanceof D;this.objectMode=!!h.objectMode,m&&(this.objectMode=this.objectMode||!!h.readableObjectMode);var _=h.highWaterMark,C=h.readableHighWaterMark,E=this.objectMode?16:16*1024;_||_===0?this.highWaterMark=_:m&&(C||C===0)?this.highWaterMark=C:this.highWaterMark=E,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new q,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=h.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,h.encoding&&(U||(U=Ke().StringDecoder),this.decoder=new U(h.encoding),this.encoding=h.encoding)}function v(h){if(D=D||Ct(),!(this instanceof v))return new v(h);this._readableState=new p(h,this),this.readable=!0,h&&(typeof h.read=="function"&&(this._read=h.read),typeof h.destroy=="function"&&(this._destroy=h.destroy)),L.call(this)}Object.defineProperty(v.prototype,"destroyed",{get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(h){this._readableState&&(this._readableState.destroyed=h)}}),v.prototype.destroy=H.destroy,v.prototype._undestroy=H.undestroy,v.prototype._destroy=function(h,l){this.push(null),l(h)},v.prototype.push=function(h,l){var m=this._readableState,_;return m.objectMode?_=!0:typeof h=="string"&&(l=l||m.defaultEncoding,l!==m.encoding&&(h=u.from(h,l),l=""),_=!0),R(this,h,l,!1,_)},v.prototype.unshift=function(h){return R(this,h,null,!0,!1)};function R(h,l,m,_,C){var E=h._readableState;if(l===null)E.reading=!1,kt(h,E);else{var P;C||(P=I(E,l)),P?h.emit("error",P):E.objectMode||l&&l.length>0?(typeof l!="string"&&!E.objectMode&&Object.getPrototypeOf(l)!==u.prototype&&(l=M(l)),_?E.endEmitted?h.emit("error",new Error("stream.unshift() after end event")):A(h,E,l,!0):E.ended?h.emit("error",new Error("stream.push() after EOF")):(E.reading=!1,E.decoder&&!m?(l=E.decoder.write(l),E.objectMode||l.length!==0?A(h,E,l,!1):d(h,E)):A(h,E,l,!1))):_||(E.reading=!1)}return j(E)}function A(h,l,m,_){l.flowing&&l.length===0&&!l.sync?(h.emit("data",m),h.read(0)):(l.length+=l.objectMode?1:m.length,_?l.buffer.unshift(m):l.buffer.push(m),l.needReadable&&Z(h)),d(h,l)}function I(h,l){var m;return!b(l)&&typeof l!="string"&&l!==void 0&&!h.objectMode&&(m=new TypeError("Invalid non-string/buffer chunk")),m}function j(h){return!h.ended&&(h.needReadable||h.length<h.highWaterMark||h.length===0)}v.prototype.isPaused=function(){return this._readableState.flowing===!1},v.prototype.setEncoding=function(h){return U||(U=Ke().StringDecoder),this._readableState.decoder=new U(h),this._readableState.encoding=h,this};var At=8388608;function F(h){return h>=At?h=At:(h--,h|=h>>>1,h|=h>>>2,h|=h>>>4,h|=h>>>8,h|=h>>>16,h++),h}function Y(h,l){return h<=0||l.length===0&&l.ended?0:l.objectMode?1:h!==h?l.flowing&&l.length?l.buffer.head.data.length:l.length:(h>l.highWaterMark&&(l.highWaterMark=F(h)),h<=l.length?h:l.ended?l.length:(l.needReadable=!0,0))}v.prototype.read=function(h){y("read",h),h=parseInt(h,10);var l=this._readableState,m=h;if(h!==0&&(l.emittedReadable=!1),h===0&&l.needReadable&&(l.length>=l.highWaterMark||l.ended))return y("read: emitReadable",l.length,l.ended),l.length===0&&l.ended?B(this):Z(this),null;if(h=Y(h,l),h===0&&l.ended)return l.length===0&&B(this),null;var _=l.needReadable;y("need readable",_),(l.length===0||l.length-h<l.highWaterMark)&&(_=!0,y("length less than watermark",_)),l.ended||l.reading?(_=!1,y("reading or ended",_)):_&&(y("do read"),l.reading=!0,l.sync=!0,l.length===0&&(l.needReadable=!0),this._read(l.highWaterMark),l.sync=!1,l.reading||(h=Y(m,l)));var C;return h>0?C=c(h,l):C=null,C===null?(l.needReadable=!0,h=0):l.length-=h,l.length===0&&(l.ended||(l.needReadable=!0),m!==h&&l.ended&&B(this)),C!==null&&this.emit("data",C),C};function kt(h,l){if(!l.ended){if(l.decoder){var m=l.decoder.end();m&&m.length&&(l.buffer.push(m),l.length+=l.objectMode?1:m.length)}l.ended=!0,Z(h)}}function Z(h){var l=h._readableState;l.needReadable=!1,l.emittedReadable||(y("emitReadable",l.flowing),l.emittedReadable=!0,l.sync?x.nextTick(Bt,h):Bt(h))}function Bt(h){y("emit readable"),h.emit("readable"),s(h)}function d(h,l){l.readingMore||(l.readingMore=!0,x.nextTick(t,h,l))}function t(h,l){for(var m=l.length;!l.reading&&!l.flowing&&!l.ended&&l.length<l.highWaterMark&&(y("maybeReadMore read 0"),h.read(0),m!==l.length);)m=l.length;l.readingMore=!1}v.prototype._read=function(h){this.emit("error",new Error("_read() is not implemented"))},v.prototype.pipe=function(h,l){var m=this,_=this._readableState;switch(_.pipesCount){case 0:_.pipes=h;break;case 1:_.pipes=[_.pipes,h];break;default:_.pipes.push(h);break}_.pipesCount+=1,y("pipe count=%d opts=%j",_.pipesCount,l);var C=(!l||l.end!==!1)&&h!==process.stdout&&h!==process.stderr,E=C?z:$;_.endEmitted?x.nextTick(E):m.once("end",E),h.on("unpipe",P);function P(K,qt){y("onunpipe"),K===m&&qt&&qt.hasUnpiped===!1&&(qt.hasUnpiped=!0,tt())}function z(){y("onend"),h.end()}var G=r(m);h.on("drain",G);var Dt=!1;function tt(){y("cleanup"),h.removeListener("close",Q),h.removeListener("finish",Nt),h.removeListener("drain",G),h.removeListener("error",X),h.removeListener("unpipe",P),m.removeListener("end",z),m.removeListener("end",$),m.removeListener("data",Wt),Dt=!0,_.awaitDrain&&(!h._writableState||h._writableState.needDrain)&&G()}var J=!1;m.on("data",Wt);function Wt(K){y("ondata"),J=!1;var qt=h.write(K);qt===!1&&!J&&((_.pipesCount===1&&_.pipes===h||_.pipesCount>1&&N(_.pipes,h)!==-1)&&!Dt&&(y("false write response, pause",_.awaitDrain),_.awaitDrain++,J=!0),m.pause())}function X(K){y("onerror",K),$(),h.removeListener("error",X),g(h,"error")===0&&h.emit("error",K)}V(h,"error",X);function Q(){h.removeListener("finish",Nt),$()}h.once("close",Q);function Nt(){y("onfinish"),h.removeListener("close",Q),$()}h.once("finish",Nt);function $(){y("unpipe"),m.unpipe(h)}return h.emit("pipe",m),_.flowing||(y("pipe resume"),m.resume()),h};function r(h){return function(){var l=h._readableState;y("pipeOnDrain",l.awaitDrain),l.awaitDrain&&l.awaitDrain--,l.awaitDrain===0&&g(h,"data")&&(l.flowing=!0,s(h))}}v.prototype.unpipe=function(h){var l=this._readableState,m={hasUnpiped:!1};if(l.pipesCount===0)return this;if(l.pipesCount===1)return h&&h!==l.pipes?this:(h||(h=l.pipes),l.pipes=null,l.pipesCount=0,l.flowing=!1,h&&h.emit("unpipe",this,m),this);if(!h){var _=l.pipes,C=l.pipesCount;l.pipes=null,l.pipesCount=0,l.flowing=!1;for(var E=0;E<C;E++)_[E].emit("unpipe",this,{hasUnpiped:!1});return this}var P=N(l.pipes,h);return P===-1?this:(l.pipes.splice(P,1),l.pipesCount-=1,l.pipesCount===1&&(l.pipes=l.pipes[0]),h.emit("unpipe",this,m),this)},v.prototype.on=function(h,l){var m=L.prototype.on.call(this,h,l);if(h==="data")this._readableState.flowing!==!1&&this.resume();else if(h==="readable"){var _=this._readableState;!_.endEmitted&&!_.readableListening&&(_.readableListening=_.needReadable=!0,_.emittedReadable=!1,_.reading?_.length&&Z(this):x.nextTick(a,this))}return m},v.prototype.addListener=v.prototype.on;function a(h){y("readable nexttick read 0"),h.read(0)}v.prototype.resume=function(){var h=this._readableState;return h.flowing||(y("resume"),h.flowing=!0,i(this,h)),this};function i(h,l){l.resumeScheduled||(l.resumeScheduled=!0,x.nextTick(n,h,l))}function n(h,l){l.reading||(y("resume read 0"),h.read(0)),l.resumeScheduled=!1,l.awaitDrain=0,h.emit("resume"),s(h),l.flowing&&!l.reading&&h.read(0)}v.prototype.pause=function(){return y("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(y("pause"),this._readableState.flowing=!1,this.emit("pause")),this};function s(h){var l=h._readableState;for(y("flow",l.flowing);l.flowing&&h.read()!==null;);}v.prototype.wrap=function(h){var l=this,m=this._readableState,_=!1;h.on("end",function(){if(y("wrapped end"),m.decoder&&!m.ended){var P=m.decoder.end();P&&P.length&&l.push(P)}l.push(null)}),h.on("data",function(P){if(y("wrapped data"),m.decoder&&(P=m.decoder.write(P)),!(m.objectMode&&P==null)&&!(!m.objectMode&&(!P||!P.length))){var z=l.push(P);z||(_=!0,h.pause())}});for(var C in h)this[C]===void 0&&typeof h[C]=="function"&&(this[C]=function(P){return function(){return h[P].apply(h,arguments)}}(C));for(var E=0;E<O.length;E++)h.on(O[E],this.emit.bind(this,O[E]));return this._read=function(P){y("wrapped _read",P),_&&(_=!1,h.resume())},this},Object.defineProperty(v.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),v._fromList=c;function c(h,l){if(l.length===0)return null;var m;return l.objectMode?m=l.buffer.shift():!h||h>=l.length?(l.decoder?m=l.buffer.join(""):l.buffer.length===1?m=l.buffer.head.data:m=l.buffer.concat(l.length),l.buffer.clear()):m=f(h,l.buffer,l.decoder),m}function f(h,l,m){var _;return h<l.head.data.length?(_=l.head.data.slice(0,h),l.head.data=l.head.data.slice(h)):h===l.head.data.length?_=l.shift():_=m?e(h,l):o(h,l),_}function e(h,l){var m=l.head,_=1,C=m.data;for(h-=C.length;m=m.next;){var E=m.data,P=h>E.length?E.length:h;if(P===E.length?C+=E:C+=E.slice(0,h),h-=P,h===0){P===E.length?(++_,m.next?l.head=m.next:l.head=l.tail=null):(l.head=m,m.data=E.slice(P));break}++_}return l.length-=_,C}function o(h,l){var m=u.allocUnsafe(h),_=l.head,C=1;for(_.data.copy(m),h-=_.data.length;_=_.next;){var E=_.data,P=h>E.length?E.length:h;if(E.copy(m,m.length-h,0,P),h-=P,h===0){P===E.length?(++C,_.next?l.head=_.next:l.head=l.tail=null):(l.head=_,_.data=E.slice(P));break}++C}return l.length-=C,m}function B(h){var l=h._readableState;if(l.length>0)throw new Error('"endReadable()" called on non-empty stream');l.endEmitted||(l.ended=!0,x.nextTick(T,l,h))}function T(h,l){!h.endEmitted&&h.length===0&&(h.endEmitted=!0,l.readable=!1,l.emit("end"))}function N(h,l){for(var m=0,_=h.length;m<_;m++)if(h[m]===l)return m;return-1}return me}var we,ze;function sr(){if(ze)return we;ze=1,we=g;var x=Ct(),k=Object.create(Ot());k.inherits=Lt(),k.inherits(g,x);function D(w,M){var b=this._transformState;b.transforming=!1;var S=b.writecb;if(!S)return this.emit("error",new Error("write callback called multiple times"));b.writechunk=null,b.writecb=null,M!=null&&this.push(M),S(w);var W=this._readableState;W.reading=!1,(W.needReadable||W.length<W.highWaterMark)&&this._read(W.highWaterMark)}function g(w){if(!(this instanceof g))return new g(w);x.call(this,w),this._transformState={afterTransform:D.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,w&&(typeof w.transform=="function"&&(this._transform=w.transform),typeof w.flush=="function"&&(this._flush=w.flush)),this.on("prefinish",L)}function L(){var w=this;typeof this._flush=="function"?this._flush(function(M,b){u(w,M,b)}):u(this,null,null)}g.prototype.push=function(w,M){return this._transformState.needTransform=!1,x.prototype.push.call(this,w,M)},g.prototype._transform=function(w,M,b){throw new Error("_transform() is not implemented")},g.prototype._write=function(w,M,b){var S=this._transformState;if(S.writecb=b,S.writechunk=w,S.writeencoding=M,!S.transforming){var W=this._readableState;(S.needTransform||W.needReadable||W.length<W.highWaterMark)&&this._read(W.highWaterMark)}},g.prototype._read=function(w){var M=this._transformState;M.writechunk!==null&&M.writecb&&!M.transforming?(M.transforming=!0,this._transform(M.writechunk,M.writeencoding,M.afterTransform)):M.needTransform=!0},g.prototype._destroy=function(w,M){var b=this;x.prototype._destroy.call(this,w,function(S){M(S),b.emit("close")})};function u(w,M,b){if(M)return w.emit("error",M);if(b!=null&&w.push(b),w._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(w._transformState.transforming)throw new Error("Calling transform done when still transforming");return w.push(null)}return we}var ye,Ve;function Br(){if(Ve)return ye;Ve=1,ye=D;var x=sr(),k=Object.create(Ot());k.inherits=Lt(),k.inherits(D,x);function D(g){if(!(this instanceof D))return new D(g);x.call(this,g)}return D.prototype._transform=function(g,L,u){u(null,g)},ye}var Ge;function kr(){return Ge||(Ge=1,function(x,k){k=x.exports=fr(),k.Stream=k,k.Readable=k,k.Writable=ar(),k.Duplex=Ct(),k.Transform=sr(),k.PassThrough=Br()}(It,It.exports)),It.exports}var Ht={exports:{}},jt={exports:{}},qr=jt.exports,Je;function hr(){return Je||(Je=1,function(x){(function(k,D){function g(d,t){if(!d)throw new Error(t||"Assertion failed")}function L(d,t){d.super_=t;var r=function(){};r.prototype=t.prototype,d.prototype=new r,d.prototype.constructor=d}function u(d,t,r){if(u.isBN(d))return d;this.negative=0,this.words=null,this.length=0,this.red=null,d!==null&&((t==="le"||t==="be")&&(r=t,t=10),this._init(d||0,t||10,r||"be"))}typeof k=="object"?k.exports=u:D.BN=u,u.BN=u,u.wordSize=26;var w;try{typeof window<"u"&&typeof window.Buffer<"u"?w=window.Buffer:w=Tt.Buffer}catch{}u.isBN=function(t){return t instanceof u?!0:t!==null&&typeof t=="object"&&t.constructor.wordSize===u.wordSize&&Array.isArray(t.words)},u.max=function(t,r){return t.cmp(r)>0?t:r},u.min=function(t,r){return t.cmp(r)<0?t:r},u.prototype._init=function(t,r,a){if(typeof t=="number")return this._initNumber(t,r,a);if(typeof t=="object")return this._initArray(t,r,a);r==="hex"&&(r=16),g(r===(r|0)&&r>=2&&r<=36),t=t.toString().replace(/\s+/g,"");var i=0;t[0]==="-"&&(i++,this.negative=1),i<t.length&&(r===16?this._parseHex(t,i,a):(this._parseBase(t,r,i),a==="le"&&this._initArray(this.toArray(),r,a)))},u.prototype._initNumber=function(t,r,a){t<0&&(this.negative=1,t=-t),t<67108864?(this.words=[t&67108863],this.length=1):t<4503599627370496?(this.words=[t&67108863,t/67108864&67108863],this.length=2):(g(t<9007199254740992),this.words=[t&67108863,t/67108864&67108863,1],this.length=3),a==="le"&&this._initArray(this.toArray(),r,a)},u.prototype._initArray=function(t,r,a){if(g(typeof t.length=="number"),t.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(t.length/3),this.words=new Array(this.length);for(var i=0;i<this.length;i++)this.words[i]=0;var n,s,c=0;if(a==="be")for(i=t.length-1,n=0;i>=0;i-=3)s=t[i]|t[i-1]<<8|t[i-2]<<16,this.words[n]|=s<<c&67108863,this.words[n+1]=s>>>26-c&67108863,c+=24,c>=26&&(c-=26,n++);else if(a==="le")for(i=0,n=0;i<t.length;i+=3)s=t[i]|t[i+1]<<8|t[i+2]<<16,this.words[n]|=s<<c&67108863,this.words[n+1]=s>>>26-c&67108863,c+=24,c>=26&&(c-=26,n++);return this._strip()};function M(d,t){var r=d.charCodeAt(t);if(r>=48&&r<=57)return r-48;if(r>=65&&r<=70)return r-55;if(r>=97&&r<=102)return r-87;g(!1,"Invalid character in "+d)}function b(d,t,r){var a=M(d,r);return r-1>=t&&(a|=M(d,r-1)<<4),a}u.prototype._parseHex=function(t,r,a){this.length=Math.ceil((t.length-r)/6),this.words=new Array(this.length);for(var i=0;i<this.length;i++)this.words[i]=0;var n=0,s=0,c;if(a==="be")for(i=t.length-1;i>=r;i-=2)c=b(t,r,i)<<n,this.words[s]|=c&67108863,n>=18?(n-=18,s+=1,this.words[s]|=c>>>26):n+=8;else{var f=t.length-r;for(i=f%2===0?r+1:r;i<t.length;i+=2)c=b(t,r,i)<<n,this.words[s]|=c&67108863,n>=18?(n-=18,s+=1,this.words[s]|=c>>>26):n+=8}this._strip()};function S(d,t,r,a){for(var i=0,n=0,s=Math.min(d.length,r),c=t;c<s;c++){var f=d.charCodeAt(c)-48;i*=a,f>=49?n=f-49+10:f>=17?n=f-17+10:n=f,g(f>=0&&n<a,"Invalid character"),i+=n}return i}u.prototype._parseBase=function(t,r,a){this.words=[0],this.length=1;for(var i=0,n=1;n<=67108863;n*=r)i++;i--,n=n/r|0;for(var s=t.length-a,c=s%i,f=Math.min(s,s-c)+a,e=0,o=a;o<f;o+=i)e=S(t,o,o+i,r),this.imuln(n),this.words[0]+e<67108864?this.words[0]+=e:this._iaddn(e);if(c!==0){var B=1;for(e=S(t,o,t.length,r),o=0;o<c;o++)B*=r;this.imuln(B),this.words[0]+e<67108864?this.words[0]+=e:this._iaddn(e)}this._strip()},u.prototype.copy=function(t){t.words=new Array(this.length);for(var r=0;r<this.length;r++)t.words[r]=this.words[r];t.length=this.length,t.negative=this.negative,t.red=this.red};function W(d,t){d.words=t.words,d.length=t.length,d.negative=t.negative,d.red=t.red}if(u.prototype._move=function(t){W(t,this)},u.prototype.clone=function(){var t=new u(null);return this.copy(t),t},u.prototype._expand=function(t){for(;this.length<t;)this.words[this.length++]=0;return this},u.prototype._strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},u.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},typeof Symbol<"u"&&typeof Symbol.for=="function")try{u.prototype[Symbol.for("nodejs.util.inspect.custom")]=y}catch{u.prototype.inspect=y}else u.prototype.inspect=y;function y(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var q=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],H=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],U=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];u.prototype.toString=function(t,r){t=t||10,r=r|0||1;var a;if(t===16||t==="hex"){a="";for(var i=0,n=0,s=0;s<this.length;s++){var c=this.words[s],f=((c<<i|n)&16777215).toString(16);n=c>>>24-i&16777215,i+=2,i>=26&&(i-=26,s--),n!==0||s!==this.length-1?a=q[6-f.length]+f+a:a=f+a}for(n!==0&&(a=n.toString(16)+a);a.length%r!==0;)a="0"+a;return this.negative!==0&&(a="-"+a),a}if(t===(t|0)&&t>=2&&t<=36){var e=H[t],o=U[t];a="";var B=this.clone();for(B.negative=0;!B.isZero();){var T=B.modrn(o).toString(t);B=B.idivn(o),B.isZero()?a=T+a:a=q[e-T.length]+T+a}for(this.isZero()&&(a="0"+a);a.length%r!==0;)a="0"+a;return this.negative!==0&&(a="-"+a),a}g(!1,"Base should be between 2 and 36")},u.prototype.toNumber=function(){var t=this.words[0];return this.length===2?t+=this.words[1]*67108864:this.length===3&&this.words[2]===1?t+=4503599627370496+this.words[1]*67108864:this.length>2&&g(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-t:t},u.prototype.toJSON=function(){return this.toString(16,2)},w&&(u.prototype.toBuffer=function(t,r){return this.toArrayLike(w,t,r)}),u.prototype.toArray=function(t,r){return this.toArrayLike(Array,t,r)};var O=function(t,r){return t.allocUnsafe?t.allocUnsafe(r):new t(r)};u.prototype.toArrayLike=function(t,r,a){this._strip();var i=this.byteLength(),n=a||Math.max(1,i);g(i<=n,"byte array longer than desired length"),g(n>0,"Requested array length <= 0");var s=O(t,n),c=r==="le"?"LE":"BE";return this["_toArrayLike"+c](s,i),s},u.prototype._toArrayLikeLE=function(t,r){for(var a=0,i=0,n=0,s=0;n<this.length;n++){var c=this.words[n]<<s|i;t[a++]=c&255,a<t.length&&(t[a++]=c>>8&255),a<t.length&&(t[a++]=c>>16&255),s===6?(a<t.length&&(t[a++]=c>>24&255),i=0,s=0):(i=c>>>24,s+=2)}if(a<t.length)for(t[a++]=i;a<t.length;)t[a++]=0},u.prototype._toArrayLikeBE=function(t,r){for(var a=t.length-1,i=0,n=0,s=0;n<this.length;n++){var c=this.words[n]<<s|i;t[a--]=c&255,a>=0&&(t[a--]=c>>8&255),a>=0&&(t[a--]=c>>16&255),s===6?(a>=0&&(t[a--]=c>>24&255),i=0,s=0):(i=c>>>24,s+=2)}if(a>=0)for(t[a--]=i;a>=0;)t[a--]=0},Math.clz32?u.prototype._countBits=function(t){return 32-Math.clz32(t)}:u.prototype._countBits=function(t){var r=t,a=0;return r>=4096&&(a+=13,r>>>=13),r>=64&&(a+=7,r>>>=7),r>=8&&(a+=4,r>>>=4),r>=2&&(a+=2,r>>>=2),a+r},u.prototype._zeroBits=function(t){if(t===0)return 26;var r=t,a=0;return(r&8191)===0&&(a+=13,r>>>=13),(r&127)===0&&(a+=7,r>>>=7),(r&15)===0&&(a+=4,r>>>=4),(r&3)===0&&(a+=2,r>>>=2),(r&1)===0&&a++,a},u.prototype.bitLength=function(){var t=this.words[this.length-1],r=this._countBits(t);return(this.length-1)*26+r};function V(d){for(var t=new Array(d.bitLength()),r=0;r<t.length;r++){var a=r/26|0,i=r%26;t[r]=d.words[a]>>>i&1}return t}u.prototype.zeroBits=function(){if(this.isZero())return 0;for(var t=0,r=0;r<this.length;r++){var a=this._zeroBits(this.words[r]);if(t+=a,a!==26)break}return t},u.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},u.prototype.toTwos=function(t){return this.negative!==0?this.abs().inotn(t).iaddn(1):this.clone()},u.prototype.fromTwos=function(t){return this.testn(t-1)?this.notn(t).iaddn(1).ineg():this.clone()},u.prototype.isNeg=function(){return this.negative!==0},u.prototype.neg=function(){return this.clone().ineg()},u.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},u.prototype.iuor=function(t){for(;this.length<t.length;)this.words[this.length++]=0;for(var r=0;r<t.length;r++)this.words[r]=this.words[r]|t.words[r];return this._strip()},u.prototype.ior=function(t){return g((this.negative|t.negative)===0),this.iuor(t)},u.prototype.or=function(t){return this.length>t.length?this.clone().ior(t):t.clone().ior(this)},u.prototype.uor=function(t){return this.length>t.length?this.clone().iuor(t):t.clone().iuor(this)},u.prototype.iuand=function(t){var r;this.length>t.length?r=t:r=this;for(var a=0;a<r.length;a++)this.words[a]=this.words[a]&t.words[a];return this.length=r.length,this._strip()},u.prototype.iand=function(t){return g((this.negative|t.negative)===0),this.iuand(t)},u.prototype.and=function(t){return this.length>t.length?this.clone().iand(t):t.clone().iand(this)},u.prototype.uand=function(t){return this.length>t.length?this.clone().iuand(t):t.clone().iuand(this)},u.prototype.iuxor=function(t){var r,a;this.length>t.length?(r=this,a=t):(r=t,a=this);for(var i=0;i<a.length;i++)this.words[i]=r.words[i]^a.words[i];if(this!==r)for(;i<r.length;i++)this.words[i]=r.words[i];return this.length=r.length,this._strip()},u.prototype.ixor=function(t){return g((this.negative|t.negative)===0),this.iuxor(t)},u.prototype.xor=function(t){return this.length>t.length?this.clone().ixor(t):t.clone().ixor(this)},u.prototype.uxor=function(t){return this.length>t.length?this.clone().iuxor(t):t.clone().iuxor(this)},u.prototype.inotn=function(t){g(typeof t=="number"&&t>=0);var r=Math.ceil(t/26)|0,a=t%26;this._expand(r),a>0&&r--;for(var i=0;i<r;i++)this.words[i]=~this.words[i]&67108863;return a>0&&(this.words[i]=~this.words[i]&67108863>>26-a),this._strip()},u.prototype.notn=function(t){return this.clone().inotn(t)},u.prototype.setn=function(t,r){g(typeof t=="number"&&t>=0);var a=t/26|0,i=t%26;return this._expand(a+1),r?this.words[a]=this.words[a]|1<<i:this.words[a]=this.words[a]&~(1<<i),this._strip()},u.prototype.iadd=function(t){var r;if(this.negative!==0&&t.negative===0)return this.negative=0,r=this.isub(t),this.negative^=1,this._normSign();if(this.negative===0&&t.negative!==0)return t.negative=0,r=this.isub(t),t.negative=1,r._normSign();var a,i;this.length>t.length?(a=this,i=t):(a=t,i=this);for(var n=0,s=0;s<i.length;s++)r=(a.words[s]|0)+(i.words[s]|0)+n,this.words[s]=r&67108863,n=r>>>26;for(;n!==0&&s<a.length;s++)r=(a.words[s]|0)+n,this.words[s]=r&67108863,n=r>>>26;if(this.length=a.length,n!==0)this.words[this.length]=n,this.length++;else if(a!==this)for(;s<a.length;s++)this.words[s]=a.words[s];return this},u.prototype.add=function(t){var r;return t.negative!==0&&this.negative===0?(t.negative=0,r=this.sub(t),t.negative^=1,r):t.negative===0&&this.negative!==0?(this.negative=0,r=t.sub(this),this.negative=1,r):this.length>t.length?this.clone().iadd(t):t.clone().iadd(this)},u.prototype.isub=function(t){if(t.negative!==0){t.negative=0;var r=this.iadd(t);return t.negative=1,r._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(t),this.negative=1,this._normSign();var a=this.cmp(t);if(a===0)return this.negative=0,this.length=1,this.words[0]=0,this;var i,n;a>0?(i=this,n=t):(i=t,n=this);for(var s=0,c=0;c<n.length;c++)r=(i.words[c]|0)-(n.words[c]|0)+s,s=r>>26,this.words[c]=r&67108863;for(;s!==0&&c<i.length;c++)r=(i.words[c]|0)+s,s=r>>26,this.words[c]=r&67108863;if(s===0&&c<i.length&&i!==this)for(;c<i.length;c++)this.words[c]=i.words[c];return this.length=Math.max(this.length,c),i!==this&&(this.negative=1),this._strip()},u.prototype.sub=function(t){return this.clone().isub(t)};function p(d,t,r){r.negative=t.negative^d.negative;var a=d.length+t.length|0;r.length=a,a=a-1|0;var i=d.words[0]|0,n=t.words[0]|0,s=i*n,c=s&67108863,f=s/67108864|0;r.words[0]=c;for(var e=1;e<a;e++){for(var o=f>>>26,B=f&67108863,T=Math.min(e,t.length-1),N=Math.max(0,e-d.length+1);N<=T;N++){var h=e-N|0;i=d.words[h]|0,n=t.words[N]|0,s=i*n+B,o+=s/67108864|0,B=s&67108863}r.words[e]=B|0,f=o|0}return f!==0?r.words[e]=f|0:r.length--,r._strip()}var v=function(t,r,a){var i=t.words,n=r.words,s=a.words,c=0,f,e,o,B=i[0]|0,T=B&8191,N=B>>>13,h=i[1]|0,l=h&8191,m=h>>>13,_=i[2]|0,C=_&8191,E=_>>>13,P=i[3]|0,z=P&8191,G=P>>>13,Dt=i[4]|0,tt=Dt&8191,J=Dt>>>13,Wt=i[5]|0,X=Wt&8191,Q=Wt>>>13,Nt=i[6]|0,$=Nt&8191,K=Nt>>>13,qt=i[7]|0,et=qt&8191,rt=qt>>>13,Se=i[8]|0,it=Se&8191,nt=Se>>>13,Re=i[9]|0,at=Re&8191,ft=Re>>>13,Ee=n[0]|0,st=Ee&8191,ht=Ee>>>13,Ae=n[1]|0,ot=Ae&8191,lt=Ae>>>13,Be=n[2]|0,ut=Be&8191,dt=Be>>>13,ke=n[3]|0,ct=ke&8191,pt=ke>>>13,qe=n[4]|0,vt=qe&8191,gt=qe>>>13,Te=n[5]|0,mt=Te&8191,wt=Te>>>13,Ne=n[6]|0,yt=Ne&8191,Mt=Ne>>>13,Ce=n[7]|0,bt=Ce&8191,_t=Ce>>>13,Le=n[8]|0,xt=Le&8191,St=Le>>>13,De=n[9]|0,Rt=De&8191,Et=De>>>13;a.negative=t.negative^r.negative,a.length=19,f=Math.imul(T,st),e=Math.imul(T,ht),e=e+Math.imul(N,st)|0,o=Math.imul(N,ht);var Kt=(c+f|0)+((e&8191)<<13)|0;c=(o+(e>>>13)|0)+(Kt>>>26)|0,Kt&=67108863,f=Math.imul(l,st),e=Math.imul(l,ht),e=e+Math.imul(m,st)|0,o=Math.imul(m,ht),f=f+Math.imul(T,ot)|0,e=e+Math.imul(T,lt)|0,e=e+Math.imul(N,ot)|0,o=o+Math.imul(N,lt)|0;var $t=(c+f|0)+((e&8191)<<13)|0;c=(o+(e>>>13)|0)+($t>>>26)|0,$t&=67108863,f=Math.imul(C,st),e=Math.imul(C,ht),e=e+Math.imul(E,st)|0,o=Math.imul(E,ht),f=f+Math.imul(l,ot)|0,e=e+Math.imul(l,lt)|0,e=e+Math.imul(m,ot)|0,o=o+Math.imul(m,lt)|0,f=f+Math.imul(T,ut)|0,e=e+Math.imul(T,dt)|0,e=e+Math.imul(N,ut)|0,o=o+Math.imul(N,dt)|0;var zt=(c+f|0)+((e&8191)<<13)|0;c=(o+(e>>>13)|0)+(zt>>>26)|0,zt&=67108863,f=Math.imul(z,st),e=Math.imul(z,ht),e=e+Math.imul(G,st)|0,o=Math.imul(G,ht),f=f+Math.imul(C,ot)|0,e=e+Math.imul(C,lt)|0,e=e+Math.imul(E,ot)|0,o=o+Math.imul(E,lt)|0,f=f+Math.imul(l,ut)|0,e=e+Math.imul(l,dt)|0,e=e+Math.imul(m,ut)|0,o=o+Math.imul(m,dt)|0,f=f+Math.imul(T,ct)|0,e=e+Math.imul(T,pt)|0,e=e+Math.imul(N,ct)|0,o=o+Math.imul(N,pt)|0;var Vt=(c+f|0)+((e&8191)<<13)|0;c=(o+(e>>>13)|0)+(Vt>>>26)|0,Vt&=67108863,f=Math.imul(tt,st),e=Math.imul(tt,ht),e=e+Math.imul(J,st)|0,o=Math.imul(J,ht),f=f+Math.imul(z,ot)|0,e=e+Math.imul(z,lt)|0,e=e+Math.imul(G,ot)|0,o=o+Math.imul(G,lt)|0,f=f+Math.imul(C,ut)|0,e=e+Math.imul(C,dt)|0,e=e+Math.imul(E,ut)|0,o=o+Math.imul(E,dt)|0,f=f+Math.imul(l,ct)|0,e=e+Math.imul(l,pt)|0,e=e+Math.imul(m,ct)|0,o=o+Math.imul(m,pt)|0,f=f+Math.imul(T,vt)|0,e=e+Math.imul(T,gt)|0,e=e+Math.imul(N,vt)|0,o=o+Math.imul(N,gt)|0;var Gt=(c+f|0)+((e&8191)<<13)|0;c=(o+(e>>>13)|0)+(Gt>>>26)|0,Gt&=67108863,f=Math.imul(X,st),e=Math.imul(X,ht),e=e+Math.imul(Q,st)|0,o=Math.imul(Q,ht),f=f+Math.imul(tt,ot)|0,e=e+Math.imul(tt,lt)|0,e=e+Math.imul(J,ot)|0,o=o+Math.imul(J,lt)|0,f=f+Math.imul(z,ut)|0,e=e+Math.imul(z,dt)|0,e=e+Math.imul(G,ut)|0,o=o+Math.imul(G,dt)|0,f=f+Math.imul(C,ct)|0,e=e+Math.imul(C,pt)|0,e=e+Math.imul(E,ct)|0,o=o+Math.imul(E,pt)|0,f=f+Math.imul(l,vt)|0,e=e+Math.imul(l,gt)|0,e=e+Math.imul(m,vt)|0,o=o+Math.imul(m,gt)|0,f=f+Math.imul(T,mt)|0,e=e+Math.imul(T,wt)|0,e=e+Math.imul(N,mt)|0,o=o+Math.imul(N,wt)|0;var Jt=(c+f|0)+((e&8191)<<13)|0;c=(o+(e>>>13)|0)+(Jt>>>26)|0,Jt&=67108863,f=Math.imul($,st),e=Math.imul($,ht),e=e+Math.imul(K,st)|0,o=Math.imul(K,ht),f=f+Math.imul(X,ot)|0,e=e+Math.imul(X,lt)|0,e=e+Math.imul(Q,ot)|0,o=o+Math.imul(Q,lt)|0,f=f+Math.imul(tt,ut)|0,e=e+Math.imul(tt,dt)|0,e=e+Math.imul(J,ut)|0,o=o+Math.imul(J,dt)|0,f=f+Math.imul(z,ct)|0,e=e+Math.imul(z,pt)|0,e=e+Math.imul(G,ct)|0,o=o+Math.imul(G,pt)|0,f=f+Math.imul(C,vt)|0,e=e+Math.imul(C,gt)|0,e=e+Math.imul(E,vt)|0,o=o+Math.imul(E,gt)|0,f=f+Math.imul(l,mt)|0,e=e+Math.imul(l,wt)|0,e=e+Math.imul(m,mt)|0,o=o+Math.imul(m,wt)|0,f=f+Math.imul(T,yt)|0,e=e+Math.imul(T,Mt)|0,e=e+Math.imul(N,yt)|0,o=o+Math.imul(N,Mt)|0;var Xt=(c+f|0)+((e&8191)<<13)|0;c=(o+(e>>>13)|0)+(Xt>>>26)|0,Xt&=67108863,f=Math.imul(et,st),e=Math.imul(et,ht),e=e+Math.imul(rt,st)|0,o=Math.imul(rt,ht),f=f+Math.imul($,ot)|0,e=e+Math.imul($,lt)|0,e=e+Math.imul(K,ot)|0,o=o+Math.imul(K,lt)|0,f=f+Math.imul(X,ut)|0,e=e+Math.imul(X,dt)|0,e=e+Math.imul(Q,ut)|0,o=o+Math.imul(Q,dt)|0,f=f+Math.imul(tt,ct)|0,e=e+Math.imul(tt,pt)|0,e=e+Math.imul(J,ct)|0,o=o+Math.imul(J,pt)|0,f=f+Math.imul(z,vt)|0,e=e+Math.imul(z,gt)|0,e=e+Math.imul(G,vt)|0,o=o+Math.imul(G,gt)|0,f=f+Math.imul(C,mt)|0,e=e+Math.imul(C,wt)|0,e=e+Math.imul(E,mt)|0,o=o+Math.imul(E,wt)|0,f=f+Math.imul(l,yt)|0,e=e+Math.imul(l,Mt)|0,e=e+Math.imul(m,yt)|0,o=o+Math.imul(m,Mt)|0,f=f+Math.imul(T,bt)|0,e=e+Math.imul(T,_t)|0,e=e+Math.imul(N,bt)|0,o=o+Math.imul(N,_t)|0;var Qt=(c+f|0)+((e&8191)<<13)|0;c=(o+(e>>>13)|0)+(Qt>>>26)|0,Qt&=67108863,f=Math.imul(it,st),e=Math.imul(it,ht),e=e+Math.imul(nt,st)|0,o=Math.imul(nt,ht),f=f+Math.imul(et,ot)|0,e=e+Math.imul(et,lt)|0,e=e+Math.imul(rt,ot)|0,o=o+Math.imul(rt,lt)|0,f=f+Math.imul($,ut)|0,e=e+Math.imul($,dt)|0,e=e+Math.imul(K,ut)|0,o=o+Math.imul(K,dt)|0,f=f+Math.imul(X,ct)|0,e=e+Math.imul(X,pt)|0,e=e+Math.imul(Q,ct)|0,o=o+Math.imul(Q,pt)|0,f=f+Math.imul(tt,vt)|0,e=e+Math.imul(tt,gt)|0,e=e+Math.imul(J,vt)|0,o=o+Math.imul(J,gt)|0,f=f+Math.imul(z,mt)|0,e=e+Math.imul(z,wt)|0,e=e+Math.imul(G,mt)|0,o=o+Math.imul(G,wt)|0,f=f+Math.imul(C,yt)|0,e=e+Math.imul(C,Mt)|0,e=e+Math.imul(E,yt)|0,o=o+Math.imul(E,Mt)|0,f=f+Math.imul(l,bt)|0,e=e+Math.imul(l,_t)|0,e=e+Math.imul(m,bt)|0,o=o+Math.imul(m,_t)|0,f=f+Math.imul(T,xt)|0,e=e+Math.imul(T,St)|0,e=e+Math.imul(N,xt)|0,o=o+Math.imul(N,St)|0;var Yt=(c+f|0)+((e&8191)<<13)|0;c=(o+(e>>>13)|0)+(Yt>>>26)|0,Yt&=67108863,f=Math.imul(at,st),e=Math.imul(at,ht),e=e+Math.imul(ft,st)|0,o=Math.imul(ft,ht),f=f+Math.imul(it,ot)|0,e=e+Math.imul(it,lt)|0,e=e+Math.imul(nt,ot)|0,o=o+Math.imul(nt,lt)|0,f=f+Math.imul(et,ut)|0,e=e+Math.imul(et,dt)|0,e=e+Math.imul(rt,ut)|0,o=o+Math.imul(rt,dt)|0,f=f+Math.imul($,ct)|0,e=e+Math.imul($,pt)|0,e=e+Math.imul(K,ct)|0,o=o+Math.imul(K,pt)|0,f=f+Math.imul(X,vt)|0,e=e+Math.imul(X,gt)|0,e=e+Math.imul(Q,vt)|0,o=o+Math.imul(Q,gt)|0,f=f+Math.imul(tt,mt)|0,e=e+Math.imul(tt,wt)|0,e=e+Math.imul(J,mt)|0,o=o+Math.imul(J,wt)|0,f=f+Math.imul(z,yt)|0,e=e+Math.imul(z,Mt)|0,e=e+Math.imul(G,yt)|0,o=o+Math.imul(G,Mt)|0,f=f+Math.imul(C,bt)|0,e=e+Math.imul(C,_t)|0,e=e+Math.imul(E,bt)|0,o=o+Math.imul(E,_t)|0,f=f+Math.imul(l,xt)|0,e=e+Math.imul(l,St)|0,e=e+Math.imul(m,xt)|0,o=o+Math.imul(m,St)|0,f=f+Math.imul(T,Rt)|0,e=e+Math.imul(T,Et)|0,e=e+Math.imul(N,Rt)|0,o=o+Math.imul(N,Et)|0;var te=(c+f|0)+((e&8191)<<13)|0;c=(o+(e>>>13)|0)+(te>>>26)|0,te&=67108863,f=Math.imul(at,ot),e=Math.imul(at,lt),e=e+Math.imul(ft,ot)|0,o=Math.imul(ft,lt),f=f+Math.imul(it,ut)|0,e=e+Math.imul(it,dt)|0,e=e+Math.imul(nt,ut)|0,o=o+Math.imul(nt,dt)|0,f=f+Math.imul(et,ct)|0,e=e+Math.imul(et,pt)|0,e=e+Math.imul(rt,ct)|0,o=o+Math.imul(rt,pt)|0,f=f+Math.imul($,vt)|0,e=e+Math.imul($,gt)|0,e=e+Math.imul(K,vt)|0,o=o+Math.imul(K,gt)|0,f=f+Math.imul(X,mt)|0,e=e+Math.imul(X,wt)|0,e=e+Math.imul(Q,mt)|0,o=o+Math.imul(Q,wt)|0,f=f+Math.imul(tt,yt)|0,e=e+Math.imul(tt,Mt)|0,e=e+Math.imul(J,yt)|0,o=o+Math.imul(J,Mt)|0,f=f+Math.imul(z,bt)|0,e=e+Math.imul(z,_t)|0,e=e+Math.imul(G,bt)|0,o=o+Math.imul(G,_t)|0,f=f+Math.imul(C,xt)|0,e=e+Math.imul(C,St)|0,e=e+Math.imul(E,xt)|0,o=o+Math.imul(E,St)|0,f=f+Math.imul(l,Rt)|0,e=e+Math.imul(l,Et)|0,e=e+Math.imul(m,Rt)|0,o=o+Math.imul(m,Et)|0;var ee=(c+f|0)+((e&8191)<<13)|0;c=(o+(e>>>13)|0)+(ee>>>26)|0,ee&=67108863,f=Math.imul(at,ut),e=Math.imul(at,dt),e=e+Math.imul(ft,ut)|0,o=Math.imul(ft,dt),f=f+Math.imul(it,ct)|0,e=e+Math.imul(it,pt)|0,e=e+Math.imul(nt,ct)|0,o=o+Math.imul(nt,pt)|0,f=f+Math.imul(et,vt)|0,e=e+Math.imul(et,gt)|0,e=e+Math.imul(rt,vt)|0,o=o+Math.imul(rt,gt)|0,f=f+Math.imul($,mt)|0,e=e+Math.imul($,wt)|0,e=e+Math.imul(K,mt)|0,o=o+Math.imul(K,wt)|0,f=f+Math.imul(X,yt)|0,e=e+Math.imul(X,Mt)|0,e=e+Math.imul(Q,yt)|0,o=o+Math.imul(Q,Mt)|0,f=f+Math.imul(tt,bt)|0,e=e+Math.imul(tt,_t)|0,e=e+Math.imul(J,bt)|0,o=o+Math.imul(J,_t)|0,f=f+Math.imul(z,xt)|0,e=e+Math.imul(z,St)|0,e=e+Math.imul(G,xt)|0,o=o+Math.imul(G,St)|0,f=f+Math.imul(C,Rt)|0,e=e+Math.imul(C,Et)|0,e=e+Math.imul(E,Rt)|0,o=o+Math.imul(E,Et)|0;var re=(c+f|0)+((e&8191)<<13)|0;c=(o+(e>>>13)|0)+(re>>>26)|0,re&=67108863,f=Math.imul(at,ct),e=Math.imul(at,pt),e=e+Math.imul(ft,ct)|0,o=Math.imul(ft,pt),f=f+Math.imul(it,vt)|0,e=e+Math.imul(it,gt)|0,e=e+Math.imul(nt,vt)|0,o=o+Math.imul(nt,gt)|0,f=f+Math.imul(et,mt)|0,e=e+Math.imul(et,wt)|0,e=e+Math.imul(rt,mt)|0,o=o+Math.imul(rt,wt)|0,f=f+Math.imul($,yt)|0,e=e+Math.imul($,Mt)|0,e=e+Math.imul(K,yt)|0,o=o+Math.imul(K,Mt)|0,f=f+Math.imul(X,bt)|0,e=e+Math.imul(X,_t)|0,e=e+Math.imul(Q,bt)|0,o=o+Math.imul(Q,_t)|0,f=f+Math.imul(tt,xt)|0,e=e+Math.imul(tt,St)|0,e=e+Math.imul(J,xt)|0,o=o+Math.imul(J,St)|0,f=f+Math.imul(z,Rt)|0,e=e+Math.imul(z,Et)|0,e=e+Math.imul(G,Rt)|0,o=o+Math.imul(G,Et)|0;var ie=(c+f|0)+((e&8191)<<13)|0;c=(o+(e>>>13)|0)+(ie>>>26)|0,ie&=67108863,f=Math.imul(at,vt),e=Math.imul(at,gt),e=e+Math.imul(ft,vt)|0,o=Math.imul(ft,gt),f=f+Math.imul(it,mt)|0,e=e+Math.imul(it,wt)|0,e=e+Math.imul(nt,mt)|0,o=o+Math.imul(nt,wt)|0,f=f+Math.imul(et,yt)|0,e=e+Math.imul(et,Mt)|0,e=e+Math.imul(rt,yt)|0,o=o+Math.imul(rt,Mt)|0,f=f+Math.imul($,bt)|0,e=e+Math.imul($,_t)|0,e=e+Math.imul(K,bt)|0,o=o+Math.imul(K,_t)|0,f=f+Math.imul(X,xt)|0,e=e+Math.imul(X,St)|0,e=e+Math.imul(Q,xt)|0,o=o+Math.imul(Q,St)|0,f=f+Math.imul(tt,Rt)|0,e=e+Math.imul(tt,Et)|0,e=e+Math.imul(J,Rt)|0,o=o+Math.imul(J,Et)|0;var ne=(c+f|0)+((e&8191)<<13)|0;c=(o+(e>>>13)|0)+(ne>>>26)|0,ne&=67108863,f=Math.imul(at,mt),e=Math.imul(at,wt),e=e+Math.imul(ft,mt)|0,o=Math.imul(ft,wt),f=f+Math.imul(it,yt)|0,e=e+Math.imul(it,Mt)|0,e=e+Math.imul(nt,yt)|0,o=o+Math.imul(nt,Mt)|0,f=f+Math.imul(et,bt)|0,e=e+Math.imul(et,_t)|0,e=e+Math.imul(rt,bt)|0,o=o+Math.imul(rt,_t)|0,f=f+Math.imul($,xt)|0,e=e+Math.imul($,St)|0,e=e+Math.imul(K,xt)|0,o=o+Math.imul(K,St)|0,f=f+Math.imul(X,Rt)|0,e=e+Math.imul(X,Et)|0,e=e+Math.imul(Q,Rt)|0,o=o+Math.imul(Q,Et)|0;var ae=(c+f|0)+((e&8191)<<13)|0;c=(o+(e>>>13)|0)+(ae>>>26)|0,ae&=67108863,f=Math.imul(at,yt),e=Math.imul(at,Mt),e=e+Math.imul(ft,yt)|0,o=Math.imul(ft,Mt),f=f+Math.imul(it,bt)|0,e=e+Math.imul(it,_t)|0,e=e+Math.imul(nt,bt)|0,o=o+Math.imul(nt,_t)|0,f=f+Math.imul(et,xt)|0,e=e+Math.imul(et,St)|0,e=e+Math.imul(rt,xt)|0,o=o+Math.imul(rt,St)|0,f=f+Math.imul($,Rt)|0,e=e+Math.imul($,Et)|0,e=e+Math.imul(K,Rt)|0,o=o+Math.imul(K,Et)|0;var fe=(c+f|0)+((e&8191)<<13)|0;c=(o+(e>>>13)|0)+(fe>>>26)|0,fe&=67108863,f=Math.imul(at,bt),e=Math.imul(at,_t),e=e+Math.imul(ft,bt)|0,o=Math.imul(ft,_t),f=f+Math.imul(it,xt)|0,e=e+Math.imul(it,St)|0,e=e+Math.imul(nt,xt)|0,o=o+Math.imul(nt,St)|0,f=f+Math.imul(et,Rt)|0,e=e+Math.imul(et,Et)|0,e=e+Math.imul(rt,Rt)|0,o=o+Math.imul(rt,Et)|0;var se=(c+f|0)+((e&8191)<<13)|0;c=(o+(e>>>13)|0)+(se>>>26)|0,se&=67108863,f=Math.imul(at,xt),e=Math.imul(at,St),e=e+Math.imul(ft,xt)|0,o=Math.imul(ft,St),f=f+Math.imul(it,Rt)|0,e=e+Math.imul(it,Et)|0,e=e+Math.imul(nt,Rt)|0,o=o+Math.imul(nt,Et)|0;var he=(c+f|0)+((e&8191)<<13)|0;c=(o+(e>>>13)|0)+(he>>>26)|0,he&=67108863,f=Math.imul(at,Rt),e=Math.imul(at,Et),e=e+Math.imul(ft,Rt)|0,o=Math.imul(ft,Et);var oe=(c+f|0)+((e&8191)<<13)|0;return c=(o+(e>>>13)|0)+(oe>>>26)|0,oe&=67108863,s[0]=Kt,s[1]=$t,s[2]=zt,s[3]=Vt,s[4]=Gt,s[5]=Jt,s[6]=Xt,s[7]=Qt,s[8]=Yt,s[9]=te,s[10]=ee,s[11]=re,s[12]=ie,s[13]=ne,s[14]=ae,s[15]=fe,s[16]=se,s[17]=he,s[18]=oe,c!==0&&(s[19]=c,a.length++),a};Math.imul||(v=p);function R(d,t,r){r.negative=t.negative^d.negative,r.length=d.length+t.length;for(var a=0,i=0,n=0;n<r.length-1;n++){var s=i;i=0;for(var c=a&67108863,f=Math.min(n,t.length-1),e=Math.max(0,n-d.length+1);e<=f;e++){var o=n-e,B=d.words[o]|0,T=t.words[e]|0,N=B*T,h=N&67108863;s=s+(N/67108864|0)|0,h=h+c|0,c=h&67108863,s=s+(h>>>26)|0,i+=s>>>26,s&=67108863}r.words[n]=c,a=s,s=i}return a!==0?r.words[n]=a:r.length--,r._strip()}function A(d,t,r){return R(d,t,r)}u.prototype.mulTo=function(t,r){var a,i=this.length+t.length;return this.length===10&&t.length===10?a=v(this,t,r):i<63?a=p(this,t,r):i<1024?a=R(this,t,r):a=A(this,t,r),a},u.prototype.mul=function(t){var r=new u(null);return r.words=new Array(this.length+t.length),this.mulTo(t,r)},u.prototype.mulf=function(t){var r=new u(null);return r.words=new Array(this.length+t.length),A(this,t,r)},u.prototype.imul=function(t){return this.clone().mulTo(t,this)},u.prototype.imuln=function(t){var r=t<0;r&&(t=-t),g(typeof t=="number"),g(t<67108864);for(var a=0,i=0;i<this.length;i++){var n=(this.words[i]|0)*t,s=(n&67108863)+(a&67108863);a>>=26,a+=n/67108864|0,a+=s>>>26,this.words[i]=s&67108863}return a!==0&&(this.words[i]=a,this.length++),r?this.ineg():this},u.prototype.muln=function(t){return this.clone().imuln(t)},u.prototype.sqr=function(){return this.mul(this)},u.prototype.isqr=function(){return this.imul(this.clone())},u.prototype.pow=function(t){var r=V(t);if(r.length===0)return new u(1);for(var a=this,i=0;i<r.length&&r[i]===0;i++,a=a.sqr());if(++i<r.length)for(var n=a.sqr();i<r.length;i++,n=n.sqr())r[i]!==0&&(a=a.mul(n));return a},u.prototype.iushln=function(t){g(typeof t=="number"&&t>=0);var r=t%26,a=(t-r)/26,i=67108863>>>26-r<<26-r,n;if(r!==0){var s=0;for(n=0;n<this.length;n++){var c=this.words[n]&i,f=(this.words[n]|0)-c<<r;this.words[n]=f|s,s=c>>>26-r}s&&(this.words[n]=s,this.length++)}if(a!==0){for(n=this.length-1;n>=0;n--)this.words[n+a]=this.words[n];for(n=0;n<a;n++)this.words[n]=0;this.length+=a}return this._strip()},u.prototype.ishln=function(t){return g(this.negative===0),this.iushln(t)},u.prototype.iushrn=function(t,r,a){g(typeof t=="number"&&t>=0);var i;r?i=(r-r%26)/26:i=0;var n=t%26,s=Math.min((t-n)/26,this.length),c=67108863^67108863>>>n<<n,f=a;if(i-=s,i=Math.max(0,i),f){for(var e=0;e<s;e++)f.words[e]=this.words[e];f.length=s}if(s!==0)if(this.length>s)for(this.length-=s,e=0;e<this.length;e++)this.words[e]=this.words[e+s];else this.words[0]=0,this.length=1;var o=0;for(e=this.length-1;e>=0&&(o!==0||e>=i);e--){var B=this.words[e]|0;this.words[e]=o<<26-n|B>>>n,o=B&c}return f&&o!==0&&(f.words[f.length++]=o),this.length===0&&(this.words[0]=0,this.length=1),this._strip()},u.prototype.ishrn=function(t,r,a){return g(this.negative===0),this.iushrn(t,r,a)},u.prototype.shln=function(t){return this.clone().ishln(t)},u.prototype.ushln=function(t){return this.clone().iushln(t)},u.prototype.shrn=function(t){return this.clone().ishrn(t)},u.prototype.ushrn=function(t){return this.clone().iushrn(t)},u.prototype.testn=function(t){g(typeof t=="number"&&t>=0);var r=t%26,a=(t-r)/26,i=1<<r;if(this.length<=a)return!1;var n=this.words[a];return!!(n&i)},u.prototype.imaskn=function(t){g(typeof t=="number"&&t>=0);var r=t%26,a=(t-r)/26;if(g(this.negative===0,"imaskn works only with positive numbers"),this.length<=a)return this;if(r!==0&&a++,this.length=Math.min(a,this.length),r!==0){var i=67108863^67108863>>>r<<r;this.words[this.length-1]&=i}return this._strip()},u.prototype.maskn=function(t){return this.clone().imaskn(t)},u.prototype.iaddn=function(t){return g(typeof t=="number"),g(t<67108864),t<0?this.isubn(-t):this.negative!==0?this.length===1&&(this.words[0]|0)<=t?(this.words[0]=t-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(t),this.negative=1,this):this._iaddn(t)},u.prototype._iaddn=function(t){this.words[0]+=t;for(var r=0;r<this.length&&this.words[r]>=67108864;r++)this.words[r]-=67108864,r===this.length-1?this.words[r+1]=1:this.words[r+1]++;return this.length=Math.max(this.length,r+1),this},u.prototype.isubn=function(t){if(g(typeof t=="number"),g(t<67108864),t<0)return this.iaddn(-t);if(this.negative!==0)return this.negative=0,this.iaddn(t),this.negative=1,this;if(this.words[0]-=t,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var r=0;r<this.length&&this.words[r]<0;r++)this.words[r]+=67108864,this.words[r+1]-=1;return this._strip()},u.prototype.addn=function(t){return this.clone().iaddn(t)},u.prototype.subn=function(t){return this.clone().isubn(t)},u.prototype.iabs=function(){return this.negative=0,this},u.prototype.abs=function(){return this.clone().iabs()},u.prototype._ishlnsubmul=function(t,r,a){var i=t.length+a,n;this._expand(i);var s,c=0;for(n=0;n<t.length;n++){s=(this.words[n+a]|0)+c;var f=(t.words[n]|0)*r;s-=f&67108863,c=(s>>26)-(f/67108864|0),this.words[n+a]=s&67108863}for(;n<this.length-a;n++)s=(this.words[n+a]|0)+c,c=s>>26,this.words[n+a]=s&67108863;if(c===0)return this._strip();for(g(c===-1),c=0,n=0;n<this.length;n++)s=-(this.words[n]|0)+c,c=s>>26,this.words[n]=s&67108863;return this.negative=1,this._strip()},u.prototype._wordDiv=function(t,r){var a=this.length-t.length,i=this.clone(),n=t,s=n.words[n.length-1]|0,c=this._countBits(s);a=26-c,a!==0&&(n=n.ushln(a),i.iushln(a),s=n.words[n.length-1]|0);var f=i.length-n.length,e;if(r!=="mod"){e=new u(null),e.length=f+1,e.words=new Array(e.length);for(var o=0;o<e.length;o++)e.words[o]=0}var B=i.clone()._ishlnsubmul(n,1,f);B.negative===0&&(i=B,e&&(e.words[f]=1));for(var T=f-1;T>=0;T--){var N=(i.words[n.length+T]|0)*67108864+(i.words[n.length+T-1]|0);for(N=Math.min(N/s|0,67108863),i._ishlnsubmul(n,N,T);i.negative!==0;)N--,i.negative=0,i._ishlnsubmul(n,1,T),i.isZero()||(i.negative^=1);e&&(e.words[T]=N)}return e&&e._strip(),i._strip(),r!=="div"&&a!==0&&i.iushrn(a),{div:e||null,mod:i}},u.prototype.divmod=function(t,r,a){if(g(!t.isZero()),this.isZero())return{div:new u(0),mod:new u(0)};var i,n,s;return this.negative!==0&&t.negative===0?(s=this.neg().divmod(t,r),r!=="mod"&&(i=s.div.neg()),r!=="div"&&(n=s.mod.neg(),a&&n.negative!==0&&n.iadd(t)),{div:i,mod:n}):this.negative===0&&t.negative!==0?(s=this.divmod(t.neg(),r),r!=="mod"&&(i=s.div.neg()),{div:i,mod:s.mod}):(this.negative&t.negative)!==0?(s=this.neg().divmod(t.neg(),r),r!=="div"&&(n=s.mod.neg(),a&&n.negative!==0&&n.isub(t)),{div:s.div,mod:n}):t.length>this.length||this.cmp(t)<0?{div:new u(0),mod:this}:t.length===1?r==="div"?{div:this.divn(t.words[0]),mod:null}:r==="mod"?{div:null,mod:new u(this.modrn(t.words[0]))}:{div:this.divn(t.words[0]),mod:new u(this.modrn(t.words[0]))}:this._wordDiv(t,r)},u.prototype.div=function(t){return this.divmod(t,"div",!1).div},u.prototype.mod=function(t){return this.divmod(t,"mod",!1).mod},u.prototype.umod=function(t){return this.divmod(t,"mod",!0).mod},u.prototype.divRound=function(t){var r=this.divmod(t);if(r.mod.isZero())return r.div;var a=r.div.negative!==0?r.mod.isub(t):r.mod,i=t.ushrn(1),n=t.andln(1),s=a.cmp(i);return s<0||n===1&&s===0?r.div:r.div.negative!==0?r.div.isubn(1):r.div.iaddn(1)},u.prototype.modrn=function(t){var r=t<0;r&&(t=-t),g(t<=67108863);for(var a=(1<<26)%t,i=0,n=this.length-1;n>=0;n--)i=(a*i+(this.words[n]|0))%t;return r?-i:i},u.prototype.modn=function(t){return this.modrn(t)},u.prototype.idivn=function(t){var r=t<0;r&&(t=-t),g(t<=67108863);for(var a=0,i=this.length-1;i>=0;i--){var n=(this.words[i]|0)+a*67108864;this.words[i]=n/t|0,a=n%t}return this._strip(),r?this.ineg():this},u.prototype.divn=function(t){return this.clone().idivn(t)},u.prototype.egcd=function(t){g(t.negative===0),g(!t.isZero());var r=this,a=t.clone();r.negative!==0?r=r.umod(t):r=r.clone();for(var i=new u(1),n=new u(0),s=new u(0),c=new u(1),f=0;r.isEven()&&a.isEven();)r.iushrn(1),a.iushrn(1),++f;for(var e=a.clone(),o=r.clone();!r.isZero();){for(var B=0,T=1;(r.words[0]&T)===0&&B<26;++B,T<<=1);if(B>0)for(r.iushrn(B);B-- >0;)(i.isOdd()||n.isOdd())&&(i.iadd(e),n.isub(o)),i.iushrn(1),n.iushrn(1);for(var N=0,h=1;(a.words[0]&h)===0&&N<26;++N,h<<=1);if(N>0)for(a.iushrn(N);N-- >0;)(s.isOdd()||c.isOdd())&&(s.iadd(e),c.isub(o)),s.iushrn(1),c.iushrn(1);r.cmp(a)>=0?(r.isub(a),i.isub(s),n.isub(c)):(a.isub(r),s.isub(i),c.isub(n))}return{a:s,b:c,gcd:a.iushln(f)}},u.prototype._invmp=function(t){g(t.negative===0),g(!t.isZero());var r=this,a=t.clone();r.negative!==0?r=r.umod(t):r=r.clone();for(var i=new u(1),n=new u(0),s=a.clone();r.cmpn(1)>0&&a.cmpn(1)>0;){for(var c=0,f=1;(r.words[0]&f)===0&&c<26;++c,f<<=1);if(c>0)for(r.iushrn(c);c-- >0;)i.isOdd()&&i.iadd(s),i.iushrn(1);for(var e=0,o=1;(a.words[0]&o)===0&&e<26;++e,o<<=1);if(e>0)for(a.iushrn(e);e-- >0;)n.isOdd()&&n.iadd(s),n.iushrn(1);r.cmp(a)>=0?(r.isub(a),i.isub(n)):(a.isub(r),n.isub(i))}var B;return r.cmpn(1)===0?B=i:B=n,B.cmpn(0)<0&&B.iadd(t),B},u.prototype.gcd=function(t){if(this.isZero())return t.abs();if(t.isZero())return this.abs();var r=this.clone(),a=t.clone();r.negative=0,a.negative=0;for(var i=0;r.isEven()&&a.isEven();i++)r.iushrn(1),a.iushrn(1);do{for(;r.isEven();)r.iushrn(1);for(;a.isEven();)a.iushrn(1);var n=r.cmp(a);if(n<0){var s=r;r=a,a=s}else if(n===0||a.cmpn(1)===0)break;r.isub(a)}while(!0);return a.iushln(i)},u.prototype.invm=function(t){return this.egcd(t).a.umod(t)},u.prototype.isEven=function(){return(this.words[0]&1)===0},u.prototype.isOdd=function(){return(this.words[0]&1)===1},u.prototype.andln=function(t){return this.words[0]&t},u.prototype.bincn=function(t){g(typeof t=="number");var r=t%26,a=(t-r)/26,i=1<<r;if(this.length<=a)return this._expand(a+1),this.words[a]|=i,this;for(var n=i,s=a;n!==0&&s<this.length;s++){var c=this.words[s]|0;c+=n,n=c>>>26,c&=67108863,this.words[s]=c}return n!==0&&(this.words[s]=n,this.length++),this},u.prototype.isZero=function(){return this.length===1&&this.words[0]===0},u.prototype.cmpn=function(t){var r=t<0;if(this.negative!==0&&!r)return-1;if(this.negative===0&&r)return 1;this._strip();var a;if(this.length>1)a=1;else{r&&(t=-t),g(t<=67108863,"Number is too big");var i=this.words[0]|0;a=i===t?0:i<t?-1:1}return this.negative!==0?-a|0:a},u.prototype.cmp=function(t){if(this.negative!==0&&t.negative===0)return-1;if(this.negative===0&&t.negative!==0)return 1;var r=this.ucmp(t);return this.negative!==0?-r|0:r},u.prototype.ucmp=function(t){if(this.length>t.length)return 1;if(this.length<t.length)return-1;for(var r=0,a=this.length-1;a>=0;a--){var i=this.words[a]|0,n=t.words[a]|0;if(i!==n){i<n?r=-1:i>n&&(r=1);break}}return r},u.prototype.gtn=function(t){return this.cmpn(t)===1},u.prototype.gt=function(t){return this.cmp(t)===1},u.prototype.gten=function(t){return this.cmpn(t)>=0},u.prototype.gte=function(t){return this.cmp(t)>=0},u.prototype.ltn=function(t){return this.cmpn(t)===-1},u.prototype.lt=function(t){return this.cmp(t)===-1},u.prototype.lten=function(t){return this.cmpn(t)<=0},u.prototype.lte=function(t){return this.cmp(t)<=0},u.prototype.eqn=function(t){return this.cmpn(t)===0},u.prototype.eq=function(t){return this.cmp(t)===0},u.red=function(t){return new Z(t)},u.prototype.toRed=function(t){return g(!this.red,"Already a number in reduction context"),g(this.negative===0,"red works only with positives"),t.convertTo(this)._forceRed(t)},u.prototype.fromRed=function(){return g(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},u.prototype._forceRed=function(t){return this.red=t,this},u.prototype.forceRed=function(t){return g(!this.red,"Already a number in reduction context"),this._forceRed(t)},u.prototype.redAdd=function(t){return g(this.red,"redAdd works only with red numbers"),this.red.add(this,t)},u.prototype.redIAdd=function(t){return g(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,t)},u.prototype.redSub=function(t){return g(this.red,"redSub works only with red numbers"),this.red.sub(this,t)},u.prototype.redISub=function(t){return g(this.red,"redISub works only with red numbers"),this.red.isub(this,t)},u.prototype.redShl=function(t){return g(this.red,"redShl works only with red numbers"),this.red.shl(this,t)},u.prototype.redMul=function(t){return g(this.red,"redMul works only with red numbers"),this.red._verify2(this,t),this.red.mul(this,t)},u.prototype.redIMul=function(t){return g(this.red,"redMul works only with red numbers"),this.red._verify2(this,t),this.red.imul(this,t)},u.prototype.redSqr=function(){return g(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},u.prototype.redISqr=function(){return g(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},u.prototype.redSqrt=function(){return g(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},u.prototype.redInvm=function(){return g(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},u.prototype.redNeg=function(){return g(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},u.prototype.redPow=function(t){return g(this.red&&!t.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,t)};var I={k256:null,p224:null,p192:null,p25519:null};function j(d,t){this.name=d,this.p=new u(t,16),this.n=this.p.bitLength(),this.k=new u(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}j.prototype._tmp=function(){var t=new u(null);return t.words=new Array(Math.ceil(this.n/13)),t},j.prototype.ireduce=function(t){var r=t,a;do this.split(r,this.tmp),r=this.imulK(r),r=r.iadd(this.tmp),a=r.bitLength();while(a>this.n);var i=a<this.n?-1:r.ucmp(this.p);return i===0?(r.words[0]=0,r.length=1):i>0?r.isub(this.p):r.strip!==void 0?r.strip():r._strip(),r},j.prototype.split=function(t,r){t.iushrn(this.n,0,r)},j.prototype.imulK=function(t){return t.imul(this.k)};function At(){j.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}L(At,j),At.prototype.split=function(t,r){for(var a=4194303,i=Math.min(t.length,9),n=0;n<i;n++)r.words[n]=t.words[n];if(r.length=i,t.length<=9){t.words[0]=0,t.length=1;return}var s=t.words[9];for(r.words[r.length++]=s&a,n=10;n<t.length;n++){var c=t.words[n]|0;t.words[n-10]=(c&a)<<4|s>>>22,s=c}s>>>=22,t.words[n-10]=s,s===0&&t.length>10?t.length-=10:t.length-=9},At.prototype.imulK=function(t){t.words[t.length]=0,t.words[t.length+1]=0,t.length+=2;for(var r=0,a=0;a<t.length;a++){var i=t.words[a]|0;r+=i*977,t.words[a]=r&67108863,r=i*64+(r/67108864|0)}return t.words[t.length-1]===0&&(t.length--,t.words[t.length-1]===0&&t.length--),t};function F(){j.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}L(F,j);function Y(){j.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}L(Y,j);function kt(){j.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}L(kt,j),kt.prototype.imulK=function(t){for(var r=0,a=0;a<t.length;a++){var i=(t.words[a]|0)*19+r,n=i&67108863;i>>>=26,t.words[a]=n,r=i}return r!==0&&(t.words[t.length++]=r),t},u._prime=function(t){if(I[t])return I[t];var r;if(t==="k256")r=new At;else if(t==="p224")r=new F;else if(t==="p192")r=new Y;else if(t==="p25519")r=new kt;else throw new Error("Unknown prime "+t);return I[t]=r,r};function Z(d){if(typeof d=="string"){var t=u._prime(d);this.m=t.p,this.prime=t}else g(d.gtn(1),"modulus must be greater than 1"),this.m=d,this.prime=null}Z.prototype._verify1=function(t){g(t.negative===0,"red works only with positives"),g(t.red,"red works only with red numbers")},Z.prototype._verify2=function(t,r){g((t.negative|r.negative)===0,"red works only with positives"),g(t.red&&t.red===r.red,"red works only with red numbers")},Z.prototype.imod=function(t){return this.prime?this.prime.ireduce(t)._forceRed(this):(W(t,t.umod(this.m)._forceRed(this)),t)},Z.prototype.neg=function(t){return t.isZero()?t.clone():this.m.sub(t)._forceRed(this)},Z.prototype.add=function(t,r){this._verify2(t,r);var a=t.add(r);return a.cmp(this.m)>=0&&a.isub(this.m),a._forceRed(this)},Z.prototype.iadd=function(t,r){this._verify2(t,r);var a=t.iadd(r);return a.cmp(this.m)>=0&&a.isub(this.m),a},Z.prototype.sub=function(t,r){this._verify2(t,r);var a=t.sub(r);return a.cmpn(0)<0&&a.iadd(this.m),a._forceRed(this)},Z.prototype.isub=function(t,r){this._verify2(t,r);var a=t.isub(r);return a.cmpn(0)<0&&a.iadd(this.m),a},Z.prototype.shl=function(t,r){return this._verify1(t),this.imod(t.ushln(r))},Z.prototype.imul=function(t,r){return this._verify2(t,r),this.imod(t.imul(r))},Z.prototype.mul=function(t,r){return this._verify2(t,r),this.imod(t.mul(r))},Z.prototype.isqr=function(t){return this.imul(t,t.clone())},Z.prototype.sqr=function(t){return this.mul(t,t)},Z.prototype.sqrt=function(t){if(t.isZero())return t.clone();var r=this.m.andln(3);if(g(r%2===1),r===3){var a=this.m.add(new u(1)).iushrn(2);return this.pow(t,a)}for(var i=this.m.subn(1),n=0;!i.isZero()&&i.andln(1)===0;)n++,i.iushrn(1);g(!i.isZero());var s=new u(1).toRed(this),c=s.redNeg(),f=this.m.subn(1).iushrn(1),e=this.m.bitLength();for(e=new u(2*e*e).toRed(this);this.pow(e,f).cmp(c)!==0;)e.redIAdd(c);for(var o=this.pow(e,i),B=this.pow(t,i.addn(1).iushrn(1)),T=this.pow(t,i),N=n;T.cmp(s)!==0;){for(var h=T,l=0;h.cmp(s)!==0;l++)h=h.redSqr();g(l<N);var m=this.pow(o,new u(1).iushln(N-l-1));B=B.redMul(m),o=m.redSqr(),T=T.redMul(o),N=l}return B},Z.prototype.invm=function(t){var r=t._invmp(this.m);return r.negative!==0?(r.negative=0,this.imod(r).redNeg()):this.imod(r)},Z.prototype.pow=function(t,r){if(r.isZero())return new u(1).toRed(this);if(r.cmpn(1)===0)return t.clone();var a=4,i=new Array(1<<a);i[0]=new u(1).toRed(this),i[1]=t;for(var n=2;n<i.length;n++)i[n]=this.mul(i[n-1],t);var s=i[0],c=0,f=0,e=r.bitLength()%26;for(e===0&&(e=26),n=r.length-1;n>=0;n--){for(var o=r.words[n],B=e-1;B>=0;B--){var T=o>>B&1;if(s!==i[0]&&(s=this.sqr(s)),T===0&&c===0){f=0;continue}c<<=1,c|=T,f++,!(f!==a&&(n!==0||B!==0))&&(s=this.mul(s,i[c]),f=0,c=0)}e=26}return s},Z.prototype.convertTo=function(t){var r=t.umod(this.m);return r===t?r.clone():r},Z.prototype.convertFrom=function(t){var r=t.clone();return r.red=null,r},u.mont=function(t){return new Bt(t)};function Bt(d){Z.call(this,d),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new u(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}L(Bt,Z),Bt.prototype.convertTo=function(t){return this.imod(t.ushln(this.shift))},Bt.prototype.convertFrom=function(t){var r=this.imod(t.mul(this.rinv));return r.red=null,r},Bt.prototype.imul=function(t,r){if(t.isZero()||r.isZero())return t.words[0]=0,t.length=1,t;var a=t.imul(r),i=a.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),n=a.isub(i).iushrn(this.shift),s=n;return n.cmp(this.m)>=0?s=n.isub(this.m):n.cmpn(0)<0&&(s=n.iadd(this.m)),s._forceRed(this)},Bt.prototype.mul=function(t,r){if(t.isZero()||r.isZero())return new u(0)._forceRed(this);var a=t.mul(r),i=a.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),n=a.isub(i).iushrn(this.shift),s=n;return n.cmp(this.m)>=0?s=n.isub(this.m):n.cmpn(0)<0&&(s=n.iadd(this.m)),s._forceRed(this)},Bt.prototype.invm=function(t){var r=this.imod(t._invmp(this.m).mul(this.r2));return r._forceRed(this)}})(x,qr)}(jt)),jt.exports}const or={"1.3.132.0.10":"secp256k1","1.3.132.0.33":"p224","1.2.840.10045.3.1.1":"p192","1.2.840.10045.3.1.7":"p256","1.3.132.0.34":"p384","1.3.132.0.35":"p521"};var Xe;function Tr(){if(Xe)return Ht.exports;Xe=1;var x=_e().Buffer,k=cr(),D=pr(),g=tr().ec,L=hr(),u=er(),w=or,M=1;function b(p,v,R,A,I){var j=u(v);if(j.curve){if(A!=="ecdsa"&&A!=="ecdsa/rsa")throw new Error("wrong private key type");return S(p,j)}else if(j.type==="dsa"){if(A!=="dsa")throw new Error("wrong private key type");return W(p,j,R)}if(A!=="rsa"&&A!=="ecdsa/rsa")throw new Error("wrong private key type");if(v.padding!==void 0&&v.padding!==M)throw new Error("illegal or unsupported padding mode");p=x.concat([I,p]);for(var At=j.modulus.byteLength(),F=[0,1];p.length+F.length+1<At;)F.push(255);F.push(0);for(var Y=-1;++Y<p.length;)F.push(p[Y]);var kt=D(F,j);return kt}function S(p,v){var R=w[v.curve.join(".")];if(!R)throw new Error("unknown curve "+v.curve.join("."));var A=new g(R),I=A.keyFromPrivate(v.privateKey),j=I.sign(p);return x.from(j.toDER())}function W(p,v,R){for(var A=v.params.priv_key,I=v.params.p,j=v.params.q,At=v.params.g,F=new L(0),Y,kt=H(p,j).mod(j),Z=!1,Bt=q(A,j,p,R);Z===!1;)Y=O(j,Bt,R),F=V(At,Y,I,j),Z=Y.invm(j).imul(kt.add(A.mul(F))).mod(j),Z.cmpn(0)===0&&(Z=!1,F=new L(0));return y(F,Z)}function y(p,v){p=p.toArray(),v=v.toArray(),p[0]&128&&(p=[0].concat(p)),v[0]&128&&(v=[0].concat(v));var R=p.length+v.length+4,A=[48,R,2,p.length];return A=A.concat(p,[2,v.length],v),x.from(A)}function q(p,v,R,A){if(p=x.from(p.toArray()),p.length<v.byteLength()){var I=x.alloc(v.byteLength()-p.length);p=x.concat([I,p])}var j=R.length,At=U(R,v),F=x.alloc(j);F.fill(1);var Y=x.alloc(j);return Y=k(A,Y).update(F).update(x.from([0])).update(p).update(At).digest(),F=k(A,Y).update(F).digest(),Y=k(A,Y).update(F).update(x.from([1])).update(p).update(At).digest(),F=k(A,Y).update(F).digest(),{k:Y,v:F}}function H(p,v){var R=new L(p),A=(p.length<<3)-v.bitLength();return A>0&&R.ishrn(A),R}function U(p,v){p=H(p,v),p=p.mod(v);var R=x.from(p.toArray());if(R.length<v.byteLength()){var A=x.alloc(v.byteLength()-R.length);R=x.concat([A,R])}return R}function O(p,v,R){var A,I;do{for(A=x.alloc(0);A.length*8<p.bitLength();)v.v=k(R,v.k).update(v.v).digest(),A=x.concat([A,v.v]);I=H(A,p),v.k=k(R,v.k).update(v.v).update(x.from([0])).digest(),v.v=k(R,v.k).update(v.v).digest()}while(I.cmp(p)!==-1);return I}function V(p,v,R,A){return p.toRed(L.mont(R)).redPow(v).fromRed().mod(A)}return Ht.exports=b,Ht.exports.getKey=q,Ht.exports.makeKey=O,Ht.exports}var Me,Qe;function Nr(){if(Qe)return Me;Qe=1;var x=_e().Buffer,k=hr(),D=tr().ec,g=er(),L=or;function u(S,W,y,q,H){var U=g(y);if(U.type==="ec"){if(q!=="ecdsa"&&q!=="ecdsa/rsa")throw new Error("wrong public key type");return w(S,W,U)}else if(U.type==="dsa"){if(q!=="dsa")throw new Error("wrong public key type");return M(S,W,U)}if(q!=="rsa"&&q!=="ecdsa/rsa")throw new Error("wrong public key type");W=x.concat([H,W]);for(var O=U.modulus.byteLength(),V=[1],p=0;W.length+V.length+2<O;)V.push(255),p+=1;V.push(0);for(var v=-1;++v<W.length;)V.push(W[v]);V=x.from(V);var R=k.mont(U.modulus);S=new k(S).toRed(R),S=S.redPow(new k(U.publicExponent)),S=x.from(S.fromRed().toArray());var A=p<8?1:0;for(O=Math.min(S.length,V.length),S.length!==V.length&&(A=1),v=-1;++v<O;)A|=S[v]^V[v];return A===0}function w(S,W,y){var q=L[y.data.algorithm.curve.join(".")];if(!q)throw new Error("unknown curve "+y.data.algorithm.curve.join("."));var H=new D(q),U=y.data.subjectPrivateKey.data;return H.verify(W,S,U)}function M(S,W,y){var q=y.data.p,H=y.data.q,U=y.data.g,O=y.data.pub_key,V=g.signature.decode(S,"der"),p=V.s,v=V.r;b(p,H),b(v,H);var R=k.mont(q),A=p.invm(H),I=U.toRed(R).redPow(new k(W).mul(A).mod(H)).fromRed().mul(O.toRed(R).redPow(v.mul(A).mod(H)).fromRed()).mod(q).mod(H);return I.cmp(v)===0}function b(S,W){if(S.cmpn(0)<=0)throw new Error("invalid sig");if(S.cmp(W)>=0)throw new Error("invalid sig")}return Me=u,Me}var be,Ye;function $r(){if(Ye)return be;Ye=1;var x=_e().Buffer,k=lr(),D=kr(),g=Lt(),L=Tr(),u=Nr(),w=rr;Object.keys(w).forEach(function(y){w[y].id=x.from(w[y].id,"hex"),w[y.toLowerCase()]=w[y]});function M(y){D.Writable.call(this);var q=w[y];if(!q)throw new Error("Unknown message digest");this._hashType=q.hash,this._hash=k(q.hash),this._tag=q.id,this._signType=q.sign}g(M,D.Writable),M.prototype._write=function(q,H,U){this._hash.update(q),U()},M.prototype.update=function(q,H){return this._hash.update(typeof q=="string"?x.from(q,H):q),this},M.prototype.sign=function(q,H){this.end();var U=this._hash.digest(),O=L(U,q,this._hashType,this._signType,this._tag);return H?O.toString(H):O};function b(y){D.Writable.call(this);var q=w[y];if(!q)throw new Error("Unknown message digest");this._hash=k(q.hash),this._tag=q.id,this._signType=q.sign}g(b,D.Writable),b.prototype._write=function(q,H,U){this._hash.update(q),U()},b.prototype.update=function(q,H){return this._hash.update(typeof q=="string"?x.from(q,H):q),this},b.prototype.verify=function(q,H,U){var O=typeof H=="string"?x.from(H,U):H;this.end();var V=this._hash.digest();return u(O,V,q,this._signType,this._tag)};function S(y){return new M(y)}function W(y){return new b(y)}return be={Sign:S,Verify:W,createSign:S,createVerify:W},be}export{Kr as a,$r as r};
